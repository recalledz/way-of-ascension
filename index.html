
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Way of Ascension ‚Äî Idle Xianxia</title>
  <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
</head>
<body>
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <mask id="playerHpMask" maskUnits="userSpaceOnUse" maskContentUnits="userSpaceOnUse">
        <rect x="0" y="0" width="100%" height="100%" fill="#fff" />
      </mask>
    </defs>
  </svg>
  <!-- SCENIC-UPDATE: drifting edge fog -->
  <div class="mist-layer"><div class="mist-a"></div><div class="mist-b"></div></div>
  <!-- MYSTIC-REALM-UPDATE: Ambient Qi particles and glimmering motes -->
  <div class="qi-particles">
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
  </div>
  <div class="glimmering-motes">
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
  </div>
  <div class="elemental-overlays">
    <div class="elemental-leaf"></div>
    <div class="elemental-leaf"></div>
    <div class="elemental-leaf"></div>
    <div class="elemental-spark"></div>
    <div class="elemental-spark"></div>
    <div class="elemental-ice"></div>
    <div class="elemental-ice"></div>
  </div>
  <header>
    <div class="primary-row">
      <button id="menuButton" class="hamburger" aria-label="Menu" aria-controls="sidebar" aria-expanded="false">‚ò∞</button>
      <div class="brand">
        <div class="qi-orb" id="qiOrb" aria-hidden="true">
        <svg class="yin-yang-svg" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet" aria-hidden="true" focusable="false">
          <path d="m 227.55034,388.44776 c -5.225,-0.97914 -13.64517,-3.17238 -18.7115,-4.87385 -5.06632,-1.70148 -12.49132,-4.74353 -16.5,-6.76012 -4.00867,-2.01658 -11.1135,-6.17029 -15.7885,-9.23045 -4.96297,-3.24866 -13.11658,-10.1627 -19.5943,-16.61544 -7.29488,-7.26674 -13.36587,-14.49703 -17.72726,-21.11242 -3.64812,-5.53351 -8.40794,-13.90288 -10.57737,-18.59861 -2.16944,-4.69573 -5.08295,-12.31832 -6.47447,-16.93909 -1.39153,-4.62076 -3.28597,-12.45139 -4.20987,-17.40139 -1.13271,-6.06874 -1.66531,-14.04828 -1.63527,-24.5 0.0325,-11.31859 0.58372,-18.2182 2.0432,-25.57607 1.09926,-5.54185 3.21743,-13.64185 4.70704,-18 1.48961,-4.35816 4.44991,-11.60028 6.57844,-16.09359 2.12853,-4.49332 6.54138,-12.14332 9.80633,-17 3.26496,-4.85669 8.93402,-12.0963 12.59792,-16.08803 3.66391,-3.99172 9.88454,-9.87209 13.82363,-13.06747 3.93909,-3.19539 9.29294,-7.25905 11.89746,-9.03037 2.60451,-1.77131 9.12951,-5.40422 14.5,-8.07313 5.37048,-2.66891 13.15774,-5.97793 17.30501,-7.35337 4.14727,-1.37545 11.34727,-3.33162 16,-4.34705 6.51896,-1.42272 12.70327,-1.84693 26.95951,-1.84924 11.482,-0.002 20.7761,0.49152 24.5,1.3006 3.3,0.71698 10.45125,2.65819 15.89167,4.31379 5.44042,1.6556 14.51867,5.38292 20.17388,8.28294 5.65522,2.90002 13.97144,7.92903 18.4805,11.17558 4.50906,3.24655 11.19341,8.8284 14.85401,12.40411 3.6607,3.57572 9.1569,9.6513 12.2138,13.5013 3.0569,3.85 7.6292,10.375 10.1607,14.5 2.5315,4.125 6.1973,11.23366 8.1463,15.79703 1.9489,4.56336 4.6575,11.98836 6.0191,16.5 1.3615,4.51163 3.1695,12.58563 4.0178,17.94221 0.8482,5.35658 1.5397,15.03158 1.5365,21.5 0,6.83748 -0.7852,16.36558 -1.8678,22.76076 -1.0241,6.05 -3.5193,15.95 -5.5448,22 -2.0256,6.05 -5.7425,14.825 -8.2598,19.5 -2.5173,4.675 -6.8821,11.84667 -9.6994,15.93705 -2.8174,4.09038 -8.9475,11.32758 -13.6225,16.08267 -4.675,4.75509 -10.525,10.23152 -12.99996,12.16984 -2.475,1.93832 -7.05441,5.15628 -10.17647,7.15102 -3.12206,1.99475 -9.77071,5.67962 -14.77478,8.1886 -5.00407,2.50899 -13.37596,5.87854 -18.60419,7.48789 -5.22823,1.60935 -13.42958,3.61244 -18.22522,4.45132 -5.37026,0.93939 -14.28876,1.49028 -23.21934,1.43424 -9.30952,-0.0584 -17.90066,-0.72826 -24,-1.87126 z m -33.19159,-24.28137 c -1.64552,-4.5375 -3.79928,-11.175 -4.78613,-14.75 -0.98684,-3.575 -2.39055,-9.65 -3.11934,-13.5 -0.7288,-3.85 -1.31688,-11.725 -1.30686,-17.5 0.01,-5.775 0.59534,-13.2 1.3007,-16.5 0.70536,-3.3 2.84672,-9.28883 4.75858,-13.30853 2.36784,-4.9784 5.44778,-9.2825 9.66037,-13.5 3.40135,-3.4053 9.10927,-7.89048 12.68427,-9.96705 3.575,-2.07658 10.1,-4.92012 14.5,-6.31898 4.4,-1.39886 14.975,-3.59226 23.5,-4.87422 8.525,-1.28197 18.38528,-3.30523 21.91173,-4.49614 3.52646,-1.19092 8.70146,-3.31494 11.5,-4.72005 2.79855,-1.40511 8.20005,-4.84847 12.00334,-7.65192 4.38388,-3.2314 9.02093,-7.93734 12.66813,-12.85631 3.4035,-4.59031 7.01524,-11.03212 8.84365,-15.77333 1.69983,-4.4078 3.57764,-11.50603 4.17291,-15.77383 0.60917,-4.36739 0.77707,-11.03838 0.38407,-15.25964 -0.38404,-4.125 -1.4922,-10.05339 -2.46259,-13.17421 -0.97039,-3.12082 -3.36038,-8.5282 -5.3111,-12.0164 -1.95071,-3.4882 -5.38286,-8.42811 -7.62699,-10.97758 -2.24413,-2.54947 -6.6684,-6.35673 -9.8317,-8.46059 -3.1633,-2.10385 -9.57645,-5.26059 -14.25145,-7.01496 -4.675,-1.75438 -12.29519,-3.74109 -16.93375,-4.41492 -5.34162,-0.77597 -12.49107,-0.98371 -19.5,-0.56661 -6.08644,0.3622 -14.89125,1.5096 -19.56625,2.54979 -4.675,1.04018 -11.425,2.99562 -15,4.34543 -3.575,1.3498 -10.325,4.36128 -15,6.69217 -4.675,2.33089 -12.98923,7.23046 -18.47607,10.88793 -5.69205,3.79427 -14.08193,10.72954 -19.53727,16.14995 -5.25865,5.225 -12.08257,13.325 -15.16425,18 -3.08168,4.675 -6.95098,11.2 -8.59846,14.5 -1.64747,3.3 -4.42354,10.04904 -6.16904,14.99787 -1.7455,4.94883 -4.04693,14.10605 -5.11428,20.34937 -1.06735,6.24333 -1.93798,15.69429 -1.93474,21.00214 0.003,5.30784 0.68129,14.15062 1.50678,19.65062 0.82548,5.5 2.89128,14.5 4.59065,20 1.69938,5.5 4.54816,13.15 6.33063,17 1.78247,3.85 5.17629,10.15 7.54183,14 2.36554,3.85 6.24489,9.475 8.62077,12.5 2.37589,3.025 6.70111,7.99395 9.61162,11.04211 2.91051,3.04815 8.21683,8.05672 11.79183,11.13014 3.575,3.07342 10.31201,8.11698 14.97113,11.2079 4.65912,3.09092 8.77669,5.61985 9.15014,5.61985 0.37345,0 -0.66733,-3.7125 -2.31286,-8.25 z m 54.00612,-163.73663 c -2.02701,-0.37265 -5.22619,-1.85271 -7.10928,-3.28901 -1.88309,-1.43631 -4.26878,-4.32436 -5.30154,-6.41791 -1.16136,-2.35424 -1.8356,-5.73496 -1.76728,-8.86138 0.0608,-2.78021 0.82625,-6.43911 1.7011,-8.13088 0.87485,-1.69178 2.94536,-4.21589 4.60115,-5.60913 1.65578,-1.39325 4.64941,-3.07407 6.65251,-3.73515 2.00309,-0.66108 5.4217,-0.96326 7.59691,-0.6715 2.1752,0.29175 5.71384,1.69447 7.86365,3.11714 2.14981,1.42268 4.81763,4.36825 5.92849,6.54573 1.26012,2.47004 2.01976,5.91553 2.01976,9.16103 0,3.6879 -0.69911,6.39491 -2.40194,9.30058 -1.34003,2.28659 -4.1032,5.03045 -6.25,6.20633 -2.11644,1.15925 -5.19806,2.32237 -6.84806,2.58472 -1.65,0.26234 -4.65846,0.17209 -6.68547,-0.20057 z m 11.97531,143.08395 c 2.04059,-1.04647 4.70118,-2.96512 5.91243,-4.26365 1.21125,-1.29853 2.89875,-4.02787 3.75,-6.0652 0.85125,-2.03732 1.53785,-5.18118 1.52577,-6.98635 -0.0121,-1.80516 -0.85795,-5.08212 -1.87971,-7.28212 -1.02176,-2.2 -2.8756,-5.06209 -4.11966,-6.3602 -1.24405,-1.29811 -3.75873,-2.98561 -5.58818,-3.75 -1.82944,-0.76439 -5.38364,-1.3898 -7.89821,-1.3898 -2.51458,0 -6.24153,0.85212 -8.28212,1.89359 -2.04059,1.04148 -4.4434,2.72898 -5.33957,3.75 -0.89618,1.02103 -2.40755,3.39106 -3.3586,5.26675 -1.24278,2.45105 -1.6122,5.02753 -1.31332,9.15957 0.29755,4.11355 1.20077,6.9353 3.17474,9.91816 1.71722,2.5949 4.33854,4.88614 6.94273,6.06847 2.30112,1.04475 6.11429,1.90942 8.4737,1.9215 2.35941,0.0121 5.95941,-0.83424 8,-1.88072 z" fill="currentColor"/>
        </svg>
      </div>
      <div class="title-wrap">
        <h1>Way of Ascension</h1>
        <div class="sub">Idle xianxia cultivation ‚Ä¢ autosaves</div>
      </div>
    </div>
  </div>
  <div class="status-row" id="statusRow" data-open="false">
    <button id="statusToggle" class="status-toggle" aria-controls="statusCluster" aria-expanded="false">Status ‚ñæ</button>
    <div id="statusCluster" class="status-cluster">
      <div class="topbar" id="top-chips">
        <div class="chip" id="taskChip">Task: <span id="currentTask">Idle</span></div>
        <div class="chip" id="realmChip">Realm: <span id="realmName">Mortal 1</span></div>
        <div class="chip" id="qiChip">Qi: <span id="qiVal">0</span>/<span id="qiCap">100</span></div>
        <div class="chip" id="stonesChip">Stones: <span id="stonesVal">0</span></div>
        <div class="chip hp-chip">HP: <span id="hpVal">100</span>/<span id="hpMax">100</span>
          <div class="hp-bar">
            <div class="fill" id="hpFill"></div>
            <svg class="shield-overlay" viewBox="0 0 100 8" preserveAspectRatio="none">
              <defs>
                <linearGradient id="shieldGradient">
                  <stop offset="0%" stop-color="rgba(255,255,255,0)" />
                  <stop offset="50%" stop-color="rgba(255,255,255,0.8)" />
                  <stop offset="100%" stop-color="rgba(255,255,255,0)" />
                </linearGradient>
              </defs>
              <mask id="hpMask">
                <rect id="hpMaskRect" x="0" y="0" width="100%" height="100%" fill="#fff" />
              </mask>
              <rect id="shieldFill" class="shield-fill" x="0" y="0" width="0" height="100%" mask="url(#hpMask)" />
              <rect class="shield-shimmer" x="0" y="0" width="100%" height="100%" mask="url(#hpMask)" fill="url(#shieldGradient)" />
            </svg>
          </div>
          <span id="hpA11y" class="sr-only">HP 100/100, Shield 0/0</span>
        </div>
        <div class="chip" id="reduceMotionChip">Reduce Motion: <input type="checkbox" id="reduceMotionToggle"></div>
      </div>
      <div class="right-actions">
        <button class="btn small ghost" id="saveBtn">üíæ Save</button>
        <button class="btn small ghost" id="exportBtn">‚¨áÔ∏è Export</button>
        <button class="btn small ghost" id="importBtn">‚¨ÜÔ∏è Import</button>
        <button class="btn small warn" id="resetBtn" title="Hard reset">‚ôªÔ∏è Reset</button>
      </div>
    </div>
  </div>
  </header>

  <div id="drawerScrim" class="drawer-scrim" hidden></div>
  <main>
    <aside class="left" id="sidebar">
      
      <!-- Leveling Activities Group -->
      <div class="activity-group">
        <h4 class="group-title"><iconify-icon icon="ri:hand-line" class="ui-icon" width="20"></iconify-icon> Training & Skills</h4>
        <div class="activities leveling-activities" id="levelingActivities"></div>
      </div>

      <!-- Separator -->
      <div class="activity-separator">
        <div class="separator-line"></div>
        <div class="separator-text">‚öîÔ∏è</div>
        <div class="separator-line"></div>
      </div>

      <!-- Exploration & Management Activities Group -->
      <div class="activity-group">
        <h4 class="group-title">Exploration & Management</h4>
        <div class="activities management-activities" id="managementActivities"></div>
      </div>

      <!-- Sect Selector -->
      <div class="activity-selector" id="sectSelector" data-activity="sect">
        <div class="activity-name">üèõÔ∏è Sect</div>
        <div class="activity-info" id="sectInfo">0 Buildings</div>
      </div>
    </aside>

    <section class="content">

      <!-- Activity Content Panels -->
      <section id="activity-cultivation" class="activity-content" style="display:none;">
        <div class="cultivation-header">
          <div class="cultivation-tabs tab-bar">
            <button class="cultivation-tab-btn active" data-tab="cultivation">Cultivation</button>
            <button class="cultivation-tab-btn" data-tab="stats">Stats</button>
          </div>
        </div>

        <div id="cultivationSubTab" class="cultivation-tab-content tab-content active">
          <div class="cultivation-layout">
          <div class="cultivation-visualization-container">
              <div class="cultivation-visualization" id="cultivationVisualization">
                <button id="openAstralTree" class="astral-tree-btn" aria-label="Astral Tree"></button>
                <div id="astralInsightMini" class="astral-insight-mini"></div>

                <!-- Misty fog layers behind silhouette -->
                <div class="misty-fog">
                  <div class="fog-layer-1"></div>
                  <div class="fog-layer-2"></div>
                  <div class="fog-layer-3"></div>
                </div>
                
                <!-- Lotus bloom effect behind silhouette -->
                <div class="lotus-bloom" id="lotusBloom">
                  <div class="bloom-petal petal-1"></div>
                  <div class="bloom-petal petal-2"></div>
                  <div class="bloom-petal petal-3"></div>
                  <div class="bloom-petal petal-4"></div>
                  <div class="bloom-petal petal-5"></div>
                  <div class="bloom-petal petal-6"></div>
                  <div class="bloom-petal petal-7"></div>
                  <div class="bloom-petal petal-8"></div>
                </div>

                <!-- Orbital rune ring around silhouette -->
                <svg class="rune-ring" viewBox="0 0 240 240" aria-hidden="true">
                  <defs>
                    <filter id="runeGlow"><feGaussianBlur stdDeviation="2" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
                    <symbol id="rune"><path d="M0,-3 L0,3 M-2,0 L2,0" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></symbol>
                  </defs>

                  <g transform="translate(120 120)">
                    <circle r="88" fill="none" stroke="rgba(255,255,255,.25)" stroke-width="1"/>
                    <g class="runes" filter="url(#runeGlow)">
                      <!-- 12 runes -->
                      <!-- you can swap <use> for your own rune paths later -->
                      <g class="orbit">
                        <!-- positions each rune on the ring -->
                        <g transform="rotate(0) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(30) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(60) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(90) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(120) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(150) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(180) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(210) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(240) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(270) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(300) translate(88 0)"><use href="#rune"/></g>
                        <g transform="rotate(330) translate(88 0)"><use href="#rune"/></g>
                      </g>
                    </g>
                  </g>
                </svg>

                <!-- Lotus pose silhouette -->
                <div class="lotus-silhouette">
                  <!-- Hidden defs: clipPath for silhouette used by CSS clip-path -->
                  <svg width="0" height="0" aria-hidden="true" focusable="false" class="silhouette-defs">
                    <defs>
                      <clipPath id="silhouetteClip" clipPathUnits="userSpaceOnUse">
                        <path d="m 256.56739,4.5708066 c -16.36452,0.47892 -32.67533,9.7638294 -39.88282,24.3671894 -3.91496,26.07871 -14.7539,54.300344 5.61719,76.587894 24.0022,30.96315 -12.20741,60.29346 -43.11133,61.62305 -28.60569,3.89868 -34.0084,34.67153 -32.91015,58.11914 3.25901,35.86328 -0.38343,73.15633 -19.22461,104.78321 -18.59572,23.5857 -26.98042,56.93936 -54.513668,72.30078 -24.62102,18.77485 -21.65213,-1.37192 -40.22461,5.70703 -15.39066,24.72925 -3.19935,32.06465 17.79688,31.89453 -22.84187,27.07773 7.97396,65.76094 40.04492,61.23633 24.048228,0.009 48.133228,0.0384 72.121088,-1.87305 32.1372,-0.26705 62.53616,-14.16906 94.28711,-15.36719 31.75095,1.19813 62.14991,15.10014 94.28711,15.36719 23.98786,1.91145 48.07285,1.88205 72.12109,1.87305 32.07095,4.52461 62.88688,-34.1586 40.04492,-61.23633 20.99626,0.17012 33.18756,-7.16528 17.79696,-31.89453 -18.57256,-7.07895 -15.60367,13.06782 -40.22469,-5.70703 -27.53325,-15.36142 -35.91795,-48.71508 -54.51367,-72.30078 -18.84118,-31.62688 -22.48362,-68.91993 -19.22461,-104.78321 1.09825,-23.44761 -4.30447,-54.22046 -32.91016,-58.11914 -30.90392,-1.32959 -67.11353,-30.6599 -43.11133,-61.62305 C 311.2041,83.23834 300.36516,55.016706 296.4502,28.937996 289.24272,14.334636 272.93191,5.0497266 256.56739,4.5708066 Z M 185.16309,270.76418 c 6.43704,20.72593 13.84261,56.35995 14.55664,79.52148 -8.18938,22.47877 -17.78979,46.88945 -35.74219,56.3125 -17.2392,18.16349 -44.55724,16.74376 -69.859366,13.97461 -3.523212,-4.85755 32.883546,-27.18747 43.175776,-39.12305 35.61875,-25.24891 42.60174,-70.7039 47.86914,-110.68554 z m 142.80859,0 c 5.2674,39.98164 12.2504,85.43663 47.86915,110.68554 10.29222,11.93558 46.69898,34.2655 43.17578,39.12305 -25.30213,2.76915 -52.62018,4.18888 -69.85938,-13.97461 -17.9524,-9.42305 -27.55281,-33.83373 -35.74219,-56.3125 0.71403,-23.16153 8.1196,-58.79555 14.55664,-79.52148 z m -71.40429,35.39453 c 0.36167,0.0137 0.72305,0.0339 1.08398,0.0605 16.1952,1.19369 28.47265,14.9393 27.66797,30.97656 -0.76815,15.32032 -13.24912,27.52066 -28.75195,28.10547 -15.50284,-0.58481 -27.9838,-12.78515 -28.75196,-28.10547 -0.80467,-16.03726 11.47277,-29.78287 27.66797,-30.97656 0.36093,-0.0267 0.72232,-0.0469 1.08399,-0.0605 z" transform="scale(0.390625)" />
                      </clipPath>
                    </defs>
                  </svg>
                  <svg viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet" class="silhouette-svg">
                    <path d="m 256.56739,4.5708066 c -16.36452,0.47892 -32.67533,9.7638294 -39.88282,24.3671894 -3.91496,26.07871 -14.7539,54.300344 5.61719,76.587894 24.0022,30.96315 -12.20741,60.29346 -43.11133,61.62305 -28.60569,3.89868 -34.0084,34.67153 -32.91015,58.11914 3.25901,35.86328 -0.38343,73.15633 -19.22461,104.78321 -18.59572,23.5857 -26.98042,56.93936 -54.513668,72.30078 -24.62102,18.77485 -21.65213,-1.37192 -40.22461,5.70703 -15.39066,24.72925 -3.19935,32.06465 17.79688,31.89453 -22.84187,27.07773 7.97396,65.76094 40.04492,61.23633 24.048228,0.009 48.133228,0.0384 72.121088,-1.87305 32.1372,-0.26705 62.53616,-14.16906 94.28711,-15.36719 31.75095,1.19813 62.14991,15.10014 94.28711,15.36719 23.98786,1.91145 48.07285,1.88205 72.12109,1.87305 32.07095,4.52461 62.88688,-34.1586 40.04492,-61.23633 20.99626,0.17012 33.18756,-7.16528 17.79696,-31.89453 -18.57256,-7.07895 -15.60367,13.06782 -40.22469,-5.70703 -27.53325,-15.36142 -35.91795,-48.71508 -54.51367,-72.30078 -18.84118,-31.62688 -22.48362,-68.91993 -19.22461,-104.78321 1.09825,-23.44761 -4.30447,-54.22046 -32.91016,-58.11914 -30.90392,-1.32959 -67.11353,-30.6599 -43.11133,-61.62305 C 311.2041,83.23834 300.36516,55.016706 296.4502,28.937996 289.24272,14.334636 272.93191,5.0497266 256.56739,4.5708066 Z M 185.16309,270.76418 c 6.43704,20.72593 13.84261,56.35995 14.55664,79.52148 -8.18938,22.47877 -17.78979,46.88945 -35.74219,56.3125 -17.2392,18.16349 -44.55724,16.74376 -69.859366,13.97461 -3.523212,-4.85755 32.883546,-27.18747 43.175776,-39.12305 35.61875,-25.24891 42.60174,-70.7039 47.86914,-110.68554 z m 142.80859,0 c 5.2674,39.98164 12.2504,85.43663 47.86915,110.68554 10.29222,11.93558 46.69898,34.2655 43.17578,39.12305 -25.30213,2.76915 -52.62018,4.18888 -69.85938,-13.97461 -17.9524,-9.42305 -27.55281,-33.83373 -35.74219,-56.3125 0.71403,-23.16153 8.1196,-58.79555 14.55664,-79.52148 z m -71.40429,35.39453 c 0.36167,0.0137 0.72305,0.0339 1.08398,0.0605 16.1952,1.19369 28.47265,14.9393 27.66797,30.97656 -0.76815,15.32032 -13.24912,27.52066 -28.75195,28.10547 -15.50284,-0.58481 -27.9838,-12.78515 -28.75196,-28.10547 -0.80467,-16.03726 11.47277,-29.78287 27.66797,-30.97656 0.36093,-0.0267 0.72232,-0.0469 1.08399,-0.0605 z" />
                  </svg>
                  <!-- Particle halo around head/upper body -->
                  <div class="particle-halo" id="particleHalo">
                    <div class="particle particle-1"></div>
                    <div class="particle particle-2"></div>
                    <div class="particle particle-3"></div>
                    <div class="particle particle-4"></div>
                    <div class="particle particle-5"></div>
                    <div class="particle particle-6"></div>
                    <div class="particle particle-7"></div>
                    <div class="particle particle-8"></div>
                    <div class="particle particle-9"></div>
                    <div class="particle particle-10"></div>
                  </div>

                  <!-- Foundation filling animation -->
                  <div class="foundation-fill" id="foundationFill">
                    <div class="qi-stream stream-1"></div>
                    <div class="qi-stream stream-2"></div>
                    <div class="qi-stream stream-3"></div>
                  <div class="qi-mist"></div>
                </div>
                  
                <!-- Yin-Yang in chest area -->
                  <div class="chest-area">
                    <div class="yin-yang-container" id="yinYangContainer">
                      <svg class="yin-yang-svg" id="cultivationYinYang" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet" aria-hidden="true" focusable="false">
                        <path d="m 227.55034,388.44776 c -5.225,-0.97914 -13.64517,-3.17238 -18.7115,-4.87385 -5.06632,-1.70148 -12.49132,-4.74353 -16.5,-6.76012 -4.00867,-2.01658 -11.1135,-6.17029 -15.7885,-9.23045 -4.96297,-3.24866 -13.11658,-10.1627 -19.5943,-16.61544 -7.29488,-7.26674 -13.36587,-14.49703 -17.72726,-21.11242 -3.64812,-5.53351 -8.40794,-13.90288 -10.57737,-18.59861 -2.16944,-4.69573 -5.08295,-12.31832 -6.47447,-16.93909 -1.39153,-4.62076 -3.28597,-12.45139 -4.20987,-17.40139 -1.13271,-6.06874 -1.66531,-14.04828 -1.63527,-24.5 0.0325,-11.31859 0.58372,-18.2182 2.0432,-25.57607 1.09926,-5.54185 3.21743,-13.64185 4.70704,-18 1.48961,-4.35816 4.44991,-11.60028 6.57844,-16.09359 2.12853,-4.49332 6.54138,-12.14332 9.80633,-17 3.26496,-4.85669 8.93402,-12.0963 12.59792,-16.08803 3.66391,-3.99172 9.88454,-9.87209 13.82363,-13.06747 3.93909,-3.19539 9.29294,-7.25905 11.89746,-9.03037 2.60451,-1.77131 9.12951,-5.40422 14.5,-8.07313 5.37048,-2.66891 13.15774,-5.97793 17.30501,-7.35337 4.14727,-1.37545 11.34727,-3.33162 16,-4.34705 6.51896,-1.42272 12.70327,-1.84693 26.95951,-1.84924 11.482,-0.002 20.7761,0.49152 24.5,1.3006 3.3,0.71698 10.45125,2.65819 15.89167,4.31379 5.44042,1.6556 14.51867,5.38292 20.17388,8.28294 5.65522,2.90002 13.97144,7.92903 18.4805,11.17558 4.50906,3.24655 11.19341,8.8284 14.85401,12.40411 3.6607,3.57572 9.1569,9.6513 12.2138,13.5013 3.0569,3.85 7.6292,10.375 10.1607,14.5 2.5315,4.125 6.1973,11.23366 8.1463,15.79703 1.9489,4.56336 4.6575,11.98836 6.0191,16.5 1.3615,4.51163 3.1695,12.58563 4.0178,17.94221 0.8482,5.35658 1.5397,15.03158 1.5365,21.5 0,6.83748 -0.7852,16.36558 -1.8678,22.76076 -1.0241,6.05 -3.5193,15.95 -5.5448,22 -2.0256,6.05 -5.7425,14.825 -8.2598,19.5 -2.5173,4.675 -6.8821,11.84667 -9.6994,15.93705 -2.8174,4.09038 -8.9475,11.32758 -13.6225,16.08267 -4.675,4.75509 -10.525,10.23152 -12.99996,12.16984 -2.475,1.93832 -7.05441,5.15628 -10.17647,7.15102 -3.12206,1.99475 -9.77071,5.67962 -14.77478,8.1886 -5.00407,2.50899 -13.37596,5.87854 -18.60419,7.48789 -5.22823,1.60935 -13.42958,3.61244 -18.22522,4.45132 -5.37026,0.93939 -14.28876,1.49028 -23.21934,1.43424 -9.30952,-0.0584 -17.90066,-0.72826 -24,-1.87126 z m -33.19159,-24.28137 c -1.64552,-4.5375 -3.79928,-11.175 -4.78613,-14.75 -0.98684,-3.575 -2.39055,-9.65 -3.11934,-13.5 -0.7288,-3.85 -1.31688,-11.725 -1.30686,-17.5 0.01,-5.775 0.59534,-13.2 1.3007,-16.5 0.70536,-3.3 2.84672,-9.28883 4.75858,-13.30853 2.36784,-4.9784 5.44778,-9.2825 9.66037,-13.5 3.40135,-3.4053 9.10927,-7.89048 12.68427,-9.96705 3.575,-2.07658 10.1,-4.92012 14.5,-6.31898 4.4,-1.39886 14.975,-3.59226 23.5,-4.87422 8.525,-1.28197 18.38528,-3.30523 21.91173,-4.49614 3.52646,-1.19092 8.70146,-3.31494 11.5,-4.72005 2.79855,-1.40511 8.20005,-4.84847 12.00334,-7.65192 4.38388,-3.2314 9.02093,-7.93734 12.66813,-12.85631 3.4035,-4.59031 7.01524,-11.03212 8.84365,-15.77333 1.69983,-4.4078 3.57764,-11.50603 4.17291,-15.77383 0.60917,-4.36739 0.77707,-11.03838 0.38407,-15.25964 -0.38404,-4.125 -1.4922,-10.05339 -2.46259,-13.17421 -0.97039,-3.12082 -3.36038,-8.5282 -5.3111,-12.0164 -1.95071,-3.4882 -5.38286,-8.42811 -7.62699,-10.97758 -2.24413,-2.54947 -6.6684,-6.35673 -9.8317,-8.46059 -3.1633,-2.10385 -9.57645,-5.26059 -14.25145,-7.01496 -4.675,-1.75438 -12.29519,-3.74109 -16.93375,-4.41492 -5.34162,-0.77597 -12.49107,-0.98371 -19.5,-0.56661 -6.08644,0.3622 -14.89125,1.5096 -19.56625,2.54979 -4.675,1.04018 -11.425,2.99562 -15,4.34543 -3.575,1.3498 -10.325,4.36128 -15,6.69217 -4.675,2.33089 -12.98923,7.23046 -18.47607,10.88793 -5.69205,3.79427 -14.08193,10.72954 -19.53727,16.14995 -5.25865,5.225 -12.08257,13.325 -15.16425,18 -3.08168,4.675 -6.95098,11.2 -8.59846,14.5 -1.64747,3.3 -4.42354,10.04904 -6.16904,14.99787 -1.7455,4.94883 -4.04693,14.10605 -5.11428,20.34937 -1.06735,6.24333 -1.93798,15.69429 -1.93474,21.00214 0.003,5.30784 0.68129,14.15062 1.50678,19.65062 0.82548,5.5 2.89128,14.5 4.59065,20 1.69938,5.5 4.54816,13.15 6.33063,17 1.78247,3.85 5.17629,10.15 7.54183,14 2.36554,3.85 6.24489,9.475 8.62077,12.5 2.37589,3.025 6.70111,7.99395 9.61162,11.04211 2.91051,3.04815 8.21683,8.05672 11.79183,11.13014 3.575,3.07342 10.31201,8.11698 14.97113,11.2079 4.65912,3.09092 8.77669,5.61985 9.15014,5.61985 0.37345,0 -0.66733,-3.7125 -2.31286,-8.25 z m 54.00612,-163.73663 c -2.02701,-0.37265 -5.22619,-1.85271 -7.10928,-3.28901 -1.88309,-1.43631 -4.26878,-4.32436 -5.30154,-6.41791 -1.16136,-2.35424 -1.8356,-5.73496 -1.76728,-8.86138 0.0608,-2.78021 0.82625,-6.43911 1.7011,-8.13088 0.87485,-1.69178 2.94536,-4.21589 4.60115,-5.60913 1.65578,-1.39325 4.64941,-3.07407 6.65251,-3.73515 2.00309,-0.66108 5.4217,-0.96326 7.59691,-0.6715 2.1752,0.29175 5.71384,1.69447 7.86365,3.11714 2.14981,1.42268 4.81763,4.36825 5.92849,6.54573 1.26012,2.47004 2.01976,5.91553 2.01976,9.16103 0,3.6879 -0.69911,6.39491 -2.40194,9.30058 -1.34003,2.28659 -4.1032,5.03045 -6.25,6.20633 -2.11644,1.15925 -5.19806,2.32237 -6.84806,2.58472 -1.65,0.26234 -4.65846,0.17209 -6.68547,-0.20057 z m 11.97531,143.08395 c 2.04059,-1.04647 4.70118,-2.96512 5.91243,-4.26365 1.21125,-1.29853 2.89875,-4.02787 3.75,-6.0652 0.85125,-2.03732 1.53785,-5.18118 1.52577,-6.98635 -0.0121,-1.80516 -0.85795,-5.08212 -1.87971,-7.28212 -1.02176,-2.2 -2.8756,-5.06209 -4.11966,-6.3602 -1.24405,-1.29811 -3.75873,-2.98561 -5.58818,-3.75 -1.82944,-0.76439 -5.38364,-1.3898 -7.89821,-1.3898 -2.51458,0 -6.24153,0.85212 -8.28212,1.89359 -2.04059,1.04148 -4.4434,2.72898 -5.33957,3.75 -0.89618,1.02103 -2.40755,3.39106 -3.3586,5.26675 -1.24278,2.45105 -1.6122,5.02753 -1.31332,9.15957 0.29755,4.11355 1.20077,6.9353 3.17474,9.91816 1.71722,2.5949 4.33854,4.88614 6.94273,6.06847 2.30112,1.04475 6.11429,1.90942 8.4737,1.9215 2.35941,0.0121 5.95941,-0.83424 8,-1.88072 z" fill="currentColor"/>
                      </svg>
                      <div class="inner-glow" id="innerGlow"></div>
                    </div>
                  </div>
                                  
                                  <!-- Ornamental outlines -->
                                  <div class="ornamental-outline"></div>
                                </div>
                <!-- Foundation text above Qi bar (no medallion) -->
                <!-- Qi display and foundation text -->
                <div class="qi-display">
                  <span class="foundation-inline"><span id="foundValSilhouette">0</span>/<span id="foundCapSilhouette">60</span></span>
                  <span id="qiText">Qi <span id="qiValSilhouette">0</span>/<span id="qiCapSilhouette">100</span></span>
                  <div class="qi-bar-silhouette">
                    <div class="qi-fill-silhouette" id="qiFillSilhouette"></div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card cultivation-controls-card">
              <div class="realm-node current" id="currentRealmNode">
                <div class="realm-icon" id="currentRealmIcon">üå±</div>
                <div class="realm-info">
                  <div class="realm-name" id="currentRealmName">Mortal</div>
                  <div class="realm-description" id="currentRealmDesc">The beginning of your cultivation journey</div>
                  <div class="realm-stages" id="currentRealmStages">
                    <!-- Stage dots will be populated by JavaScript -->
                  </div>
                </div>
              </div>
              <h4>Cultivation</h4>
              <div class="cultivation-controls-main">
                <div class="cultivation-buttons">
                  <button class="btn cultivation-btn primary" id="startCultivationActivity"> Start Cultivating</button>
                  <button class="btn cultivation-btn warn" id="breakthroughBtnActivity">Attempt Breakthrough</button>
                  <button class="btn cultivation-btn secondary" id="toggleProgressBtn"> View Progress</button>
                </div>
                <div class="cultivation-rate">Foundation gain: <span id="foundationRate">0.0</span>/s</div>
                <div class="cultivation-rate">Qi gain: <span id="qiRegenActivity">0.0</span>/s</div>
              </div>
            </div>

          </div>
        </div>

        <div id="statsSubTab" class="cultivation-tab-content tab-content" style="display:none;">
          <div class="cards">
            <div class="card">
              <h4>Breakthrough Details</h4>
              <div class="stat"><span>Success Chance</span><span id="btChanceActivity">0%</span></div>
              <div class="stat"><span>Power Multiplier</span><span id="powerMultActivity">1x</span></div>
              <div id="breakthroughDetailsActivity" class="muted"></div>
              <div class="row" style="margin-top:12px">
                <button class="btn" id="useQiPillActivity">üíä Use Qi Pill</button>
                <button class="btn" id="useWardPillActivity">üíä Use Ward Pill</button>
              </div>
            </div>

            <div class="card" id="cultivationStatsCard">
              <h4>üåü Cultivation Stats</h4>
              <p class="muted">Enhanced cultivation abilities and multipliers:</p>
              <div class="stat"><span>Talent</span><span id="cultivationTalent">1.0x</span></div>
              <div class="stat"><span>Comprehension</span><span id="cultivationComprehension">1.0x</span></div>
              <div class="stat"><span>Foundation Mult</span><span id="cultivationFoundationMult">1.0x</span></div>
              <div class="stat"><span>Pill Mult</span><span id="cultivationPillMult">1.0x</span></div>
              <div class="stat"><span>Building Mult</span><span id="cultivationBuildingMult">1.0x</span></div>
              <div class="stat"><span>Karma Points</span><span id="karmaPoints">0</span></div>
              <div class="stat"><span>Karma ATK Bonus</span><span id="karmaAtkBonus">0%</span></div>
              <div class="stat"><span>Karma Armor Bonus</span><span id="karmaArmorBonus">0%</span></div>
              <div class="stat"><span>Karma Qi Regen</span><span id="karmaQiRegenBonus">0%</span></div>
              <div class="muted" style="margin-top:8px">These multipliers enhance foundation gain, pill effectiveness, and breakthrough chances</div>
            </div>

            <div class="card" id="astralTreeTotalsCard" style="display:none;">
              <h4>üå≤ Astral Tree Effects</h4>
              <div id="astralTreeTotals"><div class="muted">No bonuses yet</div></div>
            </div>
          </div>
        </div>
      </section>

      <section id="activity-physique" class="activity-content tab-content" style="display:none;">
        <h2> Physique Training</h2>
        <div class="cards">
          <div class="card">
            <h4>Training Status</h4>
            <div class="stat"><span>Physique Level</span><span id="physiqueLevelActivity">1</span></div>
            <div class="stat"><span>Experience</span><span><span id="physiqueExpActivity">0</span>/<span id="physiqueExpMaxActivity">100</span></span></div>
            <div class="bar"><div class="fill" id="physiqueFillActivity"></div></div>
            <div class="stat"><span>Stamina</span><span><span id="currentStamina">100</span>/<span id="maxStamina">100</span></span></div>
            <div class="bar"><div class="fill" id="staminaFill"></div></div>
            <button class="btn primary" id="startPhysiqueActivity"> Start Training</button>
          </div>
          
          <div class="card" id="activeTrainingCard" style="display:none;">
            <h4> Training Session</h4>
            <p class="muted">Start a training session! Stamina drains during training. Hit the perfect zone for maximum XP!</p>
            
            <div class="training-interface">
              <div class="session-controls" id="sessionControls">
                <button class="btn primary" id="startTrainingSession"> Start Training Session</button>
                <div class="muted" style="margin-top:8px">Sessions drain stamina continuously. Hit the green zone for best results!</div>
              </div>
              
              <div class="training-game" id="trainingGame" style="display:none;">
                <div class="timing-bar-container">
                  <div class="timing-bar" id="timingBar">
                    <div class="perfect-zone" id="perfectZone"></div>
                    <div class="timing-cursor" id="timingCursor"></div>
                  </div>
                </div>
                
                <div class="game-controls">
                  <button class="btn primary large" id="hitButton"> HIT!</button>
                  <div class="session-info">
                    <div class="stat"><span>Session Stamina</span><span id="sessionStamina">100</span></div>
                    <div class="stat"><span>Hits This Session</span><span id="sessionHits">0</span></div>
                    <div class="stat"><span>Session XP</span><span id="sessionXP">0</span></div>
                  </div>
                </div>
                
                <div class="muted" style="margin-top:8px">
                  Perfect (Green): 15-25 XP | Good (Yellow): 8-12 XP | Poor (Red): 3-5 XP
                </div>
              </div>
            </div>
          </div>
          
          <div class="card" id="passiveTrainingCard" style="display:none;">
            <h4> Passive Training</h4>
            <p class="muted">Steady, continuous training at a slower pace. No stamina required.</p>
            <div class="stat"><span>Passive Rate</span><span id="passiveTrainingRate">+2 XP/sec</span></div>
            <div class="stat"><span>Total Gained</span><span id="passiveXpGained">0 XP</span></div>
            <div class="muted" style="margin-top:8px">Passive training provides steady progress while stamina recovers</div>
          </div>
          
          <div class="card" id="physiqueEffectsCard" style="display:none;">
            <h4> Physique Effects</h4>
            <p class="muted">Current bonuses from your physique stat:</p>
            <div class="stat"><span>Current Physique</span><span id="currentPhysiqueStat">10</span></div>
            <div class="stat"><span>HP Bonus</span><span id="physiqueHpStat">+0</span></div>
            <div class="stat"><span>Carry Capacity</span><span id="physiqueCarryStat">+0</span></div>
            <div class="stat"><span>Max Stamina</span><span id="physiqueMaxStaminaStat">100</span></div>
            <div class="stat"><span>Stamina Regen</span><span id="physiqueStaminaRegenStat">+0.06/s</span></div>
            <div class="stat"><span>Training Drain</span><span id="physiqueStaminaDrainStat">-6/s</span></div>
            <div class="muted" style="margin-top:8px">Higher physique improves health, stamina, and carrying capacity</div>
          </div>
        </div>
      </section>

      <section id="activity-agility" class="activity-content tab-content" style="display:none;">
        <h2> Agility Training</h2>
        <div class="cards">
          <div class="card">
            <h4>Training Status</h4>
            <div class="stat"><span>Agility Level</span><span id="agilityLevelActivity">1</span></div>
            <div class="stat"><span>Experience</span><span><span id="agilityExpActivity">0</span>/<span id="agilityExpMaxActivity">100</span></span></div>
            <div class="bar"><div class="fill" id="agilityFillActivity"></div></div>
            <div class="stat"><span>Stamina</span><span><span id="agilityCurrentStamina">100</span>/<span id="agilityMaxStamina">100</span></span></div>
            <div class="bar"><div class="fill" id="agilityStaminaFill"></div></div>
            <button class="btn primary" id="startAgilityActivity"> Start Training</button>
          </div>

          <div class="card" id="agilityActiveTrainingCard" style="display:none;">
            <h4> Training Session</h4>
            <p class="muted">Start a training session! Stamina drains during training. Hit the perfect zone for maximum XP!</p>

            <div class="training-interface">
              <div class="session-controls" id="agilitySessionControls">
                <button class="btn primary" id="startAgilityTrainingSession"> Start Training Session</button>
                <div class="muted" style="margin-top:8px">Sessions drain stamina continuously. Hit the green zone for best results!</div>
              </div>

              <div class="training-game" id="agilityTrainingGame" style="display:none;">
                <div class="timing-bar-container">
                  <div class="timing-bar" id="agilityTimingBar">
                    <div class="perfect-zone" id="agilityPerfectZone"></div>
                    <div class="timing-cursor" id="agilityTimingCursor"></div>
                  </div>
                </div>

                <div class="game-controls">
                  <button class="btn primary large" id="agilityHitButton"> HIT!</button>
                  <div class="session-info">
                    <div class="stat"><span>Session Stamina</span><span id="agilitySessionStamina">100</span></div>
                    <div class="stat"><span>Hits This Session</span><span id="agilitySessionHits">0</span></div>
                    <div class="stat"><span>Session XP</span><span id="agilitySessionXP">0</span></div>
                  </div>
                </div>

                <div class="muted" style="margin-top:8px">
                  Perfect (Green): 15-25 XP | Good (Yellow): 8-12 XP | Poor (Red): 3-5 XP
                </div>
              </div>
            </div>
          </div>

          <div class="card" id="agilityCoursesCard" style="display:none;">
            <h4> Obstacle Courses</h4>
            <div class="stat"><span>Courses Built</span><span id="obstacleCourseCount">0</span></div>
            <div class="stat"><span>XP Bonus</span><span id="agilityXpMult">+0% XP</span></div>
            <div class="stat"><span>Next Cost</span><span id="obstacleCourseCost">50 stone, 50 wood</span></div>
            <button class="btn primary" id="buildObstacleCourse">Build Course</button>
          </div>

          <div class="card" id="agilityEffectsCard" style="display:none;">
            <h4> Agility Effects</h4>
            <p class="muted">Current bonuses from your agility stat:</p>
            <div class="stat"><span>Current Agility</span><span id="currentAgilityStat">10</span></div>
            <div class="stat"><span>Accuracy Bonus</span><span id="agilityAccuracyStat">+0</span></div>
            <div class="stat"><span>Dodge Bonus</span><span id="agilityDodgeStat">+0</span></div>
            <div class="stat"><span>Forge Speed</span><span id="agilityForgeSpeedStat">+0%</span></div>
            <div class="muted" style="margin-top:8px">Higher agility improves accuracy, dodge, and forging speed</div>
          </div>
        </div>
      </section>

      <section id="activity-catching" class="activity-content tab-content" style="display:none;">
        <h2> Catching</h2>
        <div class="catching-tabs">
          <button class="catching-subtab active" data-subtab="catching-and-taming">Catching &amp; Taming</button>
          <button class="catching-subtab" data-subtab="expeditions">Expeditions</button>
          <button class="catching-subtab" data-subtab="grazing">Grazing</button>
          <button class="catching-subtab" data-subtab="training">Training</button>
        </div>
        <div id="catching-and-taming" class="catching-subtab-content">
          <div class="cards">
            <div class="card">
              <h4> Catching</h4>
              <select id="catchingLocation"></select>
              <div class="stat"><span>Catch Chance</span><span id="catchChance">0%</span></div>
              <div class="stat"><span>Nets</span><span id="catchingNets">0</span></div>
              <button class="btn primary" id="catchCritterBtn">Attempt Catch</button>
              <div class="bar"><div class="fill" id="catchProgressFill"></div></div>
            </div>
            <div class="card">
              <h4> Caught Creatures</h4>
              <div id="caughtCreatures" class="creature-list"></div>
            </div>
          </div>
        </div>
        <div id="expeditions" class="catching-subtab-content" style="display:none;">
          <div class="cards">
            <div class="card"><p class="muted">Expeditions coming soon...</p></div>
          </div>
        </div>
        <div id="grazing" class="catching-subtab-content" style="display:none;">
          <div class="cards">
            <div class="card"><p class="muted">Grazing coming soon...</p></div>
          </div>
        </div>
        <div id="training" class="catching-subtab-content" style="display:none;">
          <div class="cards">
            <div class="card"><p class="muted">Training coming soon...</p></div>
          </div>
        </div>
      </section>

      <section id="activity-mining" class="activity-content tab-content" style="display:none;">
        <h2> Mining</h2>
        <div class="cards">
          <div class="card">
            <h4>Mining Status</h4>
            <div class="stat"><span>Mining Level</span><span id="miningLevelActivity">1</span></div>
            <div class="stat"><span>Experience</span><span><span id="miningExpActivity">0</span>/<span id="miningExpMaxActivity">100</span></span></div>
            <div class="bar"><div class="fill" id="miningFillActivity"></div></div>
            <div class="stat"><span>Currently Mining</span><span id="currentlyMining">Nothing</span></div>
            <button class="btn primary" id="startMiningActivity"> Start Mining</button>
          </div>
          
          <div class="card">
            <h4>Resource Selection</h4>
            <p class="muted">Select which resource to mine. Mining is passive - resources are gained automatically over time.</p>
            <div class="mining-resources" id="miningResourceSelection">
              <div class="resource-option" data-resource="stones">
                <input type="radio" name="miningResource" id="mineStones" value="stones" checked>
                <label for="mineStones">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Spirit Stones</span>
                  <span class="resource-rate" id="stonesRate">+2-4/sec</span>
                </label>
              </div>
              <div class="resource-option" data-resource="iron" id="ironOption" style="display:none;">
                <input type="radio" name="miningResource" id="mineIron" value="iron">
                <label for="mineIron">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Iron Ore</span>
                  <span class="resource-rate" id="ironRate">+1-2/sec</span>
                </label>
              </div>
              <div class="resource-option" data-resource="ice" id="iceOption" style="display:none;">
                <input type="radio" name="miningResource" id="mineIce" value="ice">
                <label for="mineIce">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Ice Crystal</span>
                  <span class="resource-rate" id="iceRate">+0.5-1/sec</span>
                </label>
              </div>
            </div>
          </div>
          
          <div class="card" id="miningStatsCard" style="display:none;">
            <h4> Mining Progress</h4>
            <div class="stat"><span>Resources Gained</span><span id="resourcesGained">0</span></div>
            <div class="stat"><span>Mining Rate</span><span id="currentMiningRate">0/sec</span></div>
            <div class="muted" style="margin-top:8px">Mining grants experience over time</div>
          </div>
        </div>
      </section>

      <section id="activity-gathering" class="activity-content tab-content" style="display:none;">
        <h2> Gathering</h2>
        <div class="cards">
          <div class="card">
            <h4>Gathering Status</h4>
            <div class="stat"><span>Gathering Level</span><span id="gatheringLevelActivity">1</span></div>
            <div class="stat"><span>Experience</span><span><span id="gatheringExpActivity">0</span>/<span id="gatheringExpMaxActivity">100</span></span></div>
            <div class="bar"><div class="fill" id="gatheringFillActivity"></div></div>
            <div class="stat"><span>Currently Gathering</span><span id="currentlyGathering">Nothing</span></div>
            <button class="btn primary" id="startGatheringActivity"> Start Gathering</button>
          </div>

          <div class="card">
            <h4>Resource Selection</h4>
            <p class="muted">Select which resource to gather. Gathering is passive - resources are gained automatically over time.</p>
            <div class="mining-resources" id="gatheringResourceSelection">
              <div class="resource-option" data-resource="wood">
                <input type="radio" name="gatheringResource" id="gatherWood" value="wood" checked>
                <label for="gatherWood">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Wood</span>
                  <span class="resource-rate" id="woodRate">+2-4/sec</span>
                </label>
              </div>
              <div class="resource-option" data-resource="herbs" id="herbsOption" style="display:none;">
                <input type="radio" name="gatheringResource" id="gatherHerbs" value="herbs">
                <label for="gatherHerbs">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Herbs</span>
                  <span class="resource-rate" id="herbsRate">+1-2/sec</span>
                </label>
              </div>
            </div>
          </div>

          <div class="card" id="gatheringStatsCard" style="display:none;">
            <h4> Gathering Progress</h4>
            <div class="stat"><span id="gatheredResourceLabel">Resources Collected</span><span id="gatheredResource">0</span></div>
            <div class="stat"><span>Gathering Rate</span><span id="currentGatheringRate">0/sec</span></div>
            <div class="muted" style="margin-top:8px">Gathering grants experience over time</div>
          </div>
        </div>
      </section>

      <section id="activity-forging" class="activity-content tab-content" style="display:none;">
        <h2>‚öíÔ∏è Forging</h2>
        <div class="cards">
          <div class="card">
            <h4>Forging</h4>
            <div class="stat"><span>Level</span><span id="forgingLevel">1</span></div>
            <div class="stat"><span>Experience</span><span id="forgingExp">0</span> / <span id="forgingExpMax">100</span></div>
            <div class="progress-bar"><div class="progress-fill" id="forgingProgressFill"></div></div>
            <div class="stat"><span>Status</span><span id="forgingStatus">Idle</span></div>
            <div id="forgeSlot" class="forge-slot">Select an item</div>
            <div id="forgeReqs" class="forge-reqs"></div>
            <div id="forgeOptions" class="forge-options"></div>
          </div>
          <div class="card">
            <h4>Inventory</h4>
            <div id="forgeInventory" class="forge-inventory"></div>
          </div>
        </div>
      </section>

      <section id="activity-adventure" class="activity-content" style="display:none;">
        <h2>üó∫Ô∏è Adventure</h2>
        <div class="adventure-layout"> <!-- MAP-UI-UPDATE -->
          <!-- Horizontal Progress Bar -->
          <div class="adventure-progress-container"> <!-- MAP-UI-UPDATE -->
            <div class="adventure-progress-bar" id="adventureProgressBar"> <!-- MAP-UI-UPDATE -->
              <!-- Progress segments will be populated by JavaScript -->
            </div>
            <div class="adventure-progress-info"> <!-- MAP-UI-UPDATE -->
              <div class="progress-kills"><span id="killsRequired">0/5</span> kills</div> <!-- MAP-UI-UPDATE -->
            </div>
          </div>
        
        <div class="cards adventure-cards"> <!-- MAP-UI-UPDATE -->
          
          <!-- Persistent Battle Display -->
          <div class="card battle-card expanded-battle"> <!-- MAP-UI-UPDATE -->
            <div class="card-header battle-header"> <!-- MAP-UI-UPDATE -->
              <h4>‚öîÔ∏è Battle Arena</h4>
              <button class="btn small ghost map-button" id="mapButton" title="Adventure Map">üó∫Ô∏è Map</button> <!-- MAP-UI-UPDATE -->
            </div>
            
            <div class="battle-area" id="battleArea">
              <div class="area-background" id="areaBackground"></div>

              <div class="combat-hud">
                <div class="hud player">
                    <div class="bar-group">
                      <div class="player-name" id="playerName">You</div>
                      <div class="health-bar">
                        <div class="stun-bar" id="playerStunBar">
                          <div class="stun-fill" id="playerStunFill"></div>
                        </div>
                        <div class="health-fill" id="playerHealthFill"></div>
                        <svg class="shield-overlay" id="advShieldOverlay" viewBox="0 0 100 24" preserveAspectRatio="none">
                        <defs>
                          <linearGradient id="advShieldGradient">
                            <stop offset="0%" stop-color="rgba(255,255,255,0)" />
                            <stop offset="50%" stop-color="rgba(255,255,255,0.8)" />
                            <stop offset="100%" stop-color="rgba(255,255,255,0)" />
                          </linearGradient>
                        </defs>
                        <mask id="advHpMask">
                          <rect id="advHpMaskRect" x="0" y="0" width="100%" height="100%" fill="#fff" />
                        </mask>
                        <rect id="advShieldFill" class="shield-fill" x="0" y="0" width="0" height="100%" mask="url(#advHpMask)" />
                        <rect class="shield-shimmer" x="0" y="0" width="100%" height="100%" mask="url(#advHpMask)" fill="url(#advShieldGradient)" />
                      </svg>
                      <span class="health-text" id="playerHealthText">100/100</span>
                    </div>
                    <div class="qi-bar">
                      <div class="qi-fill" id="playerQiFill"></div>
                      <span class="qi-text" id="playerQiText">0/0</span>
                    </div>
                    <div class="status-ailments" id="playerAilments"></div>
                  </div>
                  <div class="stat-icons">
                    <span class="icon" id="playerAttack" title="ATK">‚öîÔ∏è</span>
                    <span class="icon" id="playerAttackRate" title="Rate">‚è±Ô∏è</span>
                    <span class="icon" id="playerMitigation" title="Mit">üõ°Ô∏è</span>
                  </div>
                </div>

                <div class="hud enemy">
                  <div class="bar-group">
                    <div class="enemy-name" id="enemyName">Select an area to begin</div>
                    <div class="health-bar">
                      <div class="stun-bar" id="enemyStunBar" title="Gauge: 0&#10;Threshold: 100&#10;Decay: 6/s">
                        <div class="stun-fill" id="enemyStunFill"></div>
                      </div>
                      <div class="health-fill" id="enemyHealthFill"></div>
                      <span class="health-text" id="enemyHealthText">--/--</span>
                    </div>
                    <div class="qi-bar">
                      <div class="qi-fill" id="enemyQiFill"></div>
                      <span class="qi-text" id="enemyQiText">--</span>
                    </div>
                    <div class="enemy-affixes" id="enemyAffixes"></div>
                    <div class="status-ailments" id="enemyAilments"></div>
                  </div>
                  <div class="stat-icons">
                    <span class="icon" id="enemyAttack" title="ATK">‚öîÔ∏è</span>
                    <span class="icon" id="enemyAttackRate" title="Rate">‚è±Ô∏è</span>
                    <span class="icon" id="enemyMitigation" title="Mit">üõ°Ô∏è</span>
                  </div>
                </div>
              </div>

              <div class="sprite-stage">
                <svg class="fx-layer" id="combatFx" viewBox="0 0 100 50" preserveAspectRatio="none">
                  <defs>
                    <filter id="soft-glow" x="-50%" y="-50%" width="200%" height="200%">
                      <feGaussianBlur stdDeviation="2" result="blur" />
                      <feMerge>
                        <feMergeNode in="blur" />
                        <feMergeNode in="SourceGraphic" />
                      </feMerge>
                    </filter>
                    <linearGradient id="fx-gradient" x1="0" y1="0" x2="1" y2="1">
                      <stop offset="0%" stop-color="var(--fx-a, #fff)" />
                      <stop offset="100%" stop-color="var(--fx-b, #fff)" />
                    </linearGradient>
                    <linearGradient id="elem-fire" x1="0" y1="0" x2="1" y2="1">
                      <stop offset="0%" stop-color="#ff9a00" />
                      <stop offset="100%" stop-color="#ff0000" />
                    </linearGradient>
                    <linearGradient id="elem-ice" x1="0" y1="0" x2="1" y2="1">
                      <stop offset="0%" stop-color="#00c6ff" />
                      <stop offset="100%" stop-color="#0072ff" />
                    </linearGradient>
                    <symbol id="rune-circle" viewBox="0 0 100 100">
                      <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="6" />
                    </symbol>
                    <symbol id="shockwave-ring" viewBox="0 0 100 100">
                      <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="10" />
                    </symbol>
                  </defs>
                </svg>
                <div class="combatant player">
                  <div class="sprite player-sprite"></div>
                  <div class="cast-bar" id="playerCastBar"><div class="fill" id="playerCastFill"></div></div>
                </div>
                <div class="combatant enemy">
                  <div class="sprite enemy-sprite"></div>
                  <div class="cast-bar" id="enemyCastBar"><div class="fill" id="enemyCastFill"></div></div>
                </div>
              </div>

              <!-- Ability Bar -->
              <div class="ability-bar-container">
                <div class="ability-bar" id="abilityBar"></div>
              </div>

              <!-- Combat Actions -->
              <div class="combat-controls">
                <button class="btn primary" id="startBattleButton">Start Battle</button>
                <button class="btn success" id="progressButton" disabled>Clear Area</button>
                <button class="btn danger" id="challengeBossButton" disabled style="display: none;">üëπ Challenge Boss</button>
              </div>
            </div>

            <!-- Combat Log -->
            <div class="combat-log" id="combatLog">
              <div class="log-entry">Select an area to begin your adventure...</div>
            </div>
          </div>
          
          <!-- Adventure Tabs -->
          <div class="card adventure-tabs-card">
            <div class="adventure-tabs tab-bar">
              <button class="adventure-tab-btn active" data-tab="progress">üìä Progress</button>
              <button class="adventure-tab-btn" data-tab="bestiary">üìñ Bestiary</button>
              <button class="adventure-tab-btn" data-tab="loot">üí∞ Loot</button>
              <button class="adventure-tab-btn" data-tab="proficiencies">ü•ä Proficiencies</button>
            </div>
            
            <!-- Progress Tab -->
            <div id="progressTab" class="adventure-tab-content tab-content active">
              <div class="stat"><span>Total Kills</span><span id="totalKills">0</span></div>
              <div class="stat"><span>Areas Completed</span><span id="areasCompleted">0</span></div>
              <div class="stat"><span>Zones Unlocked</span><span id="zonesUnlocked">1</span></div>
              <div class="combat-info">
                <div class="stat"><span>Weapon</span><span id="currentWeapon">Fists</span></div>
                <div class="stat"><span>Base Damage</span><span id="baseDamage">5</span></div>
                <div class="stat"><span>Attack Rate</span><span id="combatAttackRate">1.0/s</span></div>
                <div class="stat"><span>Hit Chance</span><span id="hitChance">--</span></div>
                <div class="stat"><span>Evade Chance</span><span id="evadeChance">--</span></div>
                <div class="stat"><span>Qi Shield</span><span id="qiShield">0/0</span></div>
                <div class="muted" style="margin-top:8px">Higher dexterity increases attack rate.</div>
              </div>
            </div>
            
            <!-- Bestiary Tab -->
            <div id="bestiaryTab" class="adventure-tab-content tab-content" style="display: none;">
              <div class="bestiary-list" id="bestiaryList">
                <div class="muted">Defeat enemies to unlock their information...</div>
              </div>
            </div>

            <!-- Loot Tab -->
            <div id="lootTab" class="adventure-tab-content tab-content" style="display: none;">
              <div class="muted warn">Items here are not safe. Retreat to claim; death forfeits them.</div>
              <div class="session-loot-list" id="sessionLootList"></div>
              <div class="loot-actions" style="text-align:right; margin-top:8px;">
                <button class="btn small" id="claimLootBtn">Retreat & Claim</button>
                <button class="btn small warn" id="forfeitLootBtn">Abandon</button>
              </div>
            </div>
            
            <!-- Proficiencies Tab -->
            <div id="proficienciesTab" class="adventure-tab-content tab-content" style="display: none;">
              <div class="stat"><span id="weaponLabel">Fists Level</span><span id="weaponLevel">1</span></div>
              <div class="stat"><span>Experience</span><span id="weaponExp">0</span> / <span id="weaponExpMax">100</span></div>
              <div class="activity-progress-bar"><div class="progress-fill" id="weaponExpFill"></div></div>
              <div class="stat"><span>Bonus</span><span id="weaponBonus">1.00</span></div>
            </div>
          </div>
        </div>
        </div> <!-- MAP-UI-UPDATE -->
        
        <!-- Map Overlay Modal - MAP-UI-UPDATE -->
        <div class="modal-overlay" id="mapOverlay" style="display: none;">
          <div class="modal-backdrop"></div>
          <div class="modal-content map-panel">
            <div class="map-header">
              <h3>üó∫Ô∏è Adventure Map</h3>
              <button class="btn small ghost close-button" id="closeMapButton" aria-label="Close map">‚úï</button>
            </div>
            <div class="map-tabs tab-bar">
              <button class="map-tab-btn active" id="mapTabAreas">Areas</button>
              <button class="map-tab-btn" id="mapTabDungeons">Dungeons</button>
            </div>
            <div class="map-content" id="mapContentAreas">
              <!-- Zone accordions will be populated by JavaScript -->
            </div>
            <div class="map-content" id="mapContentDungeons" style="display:none;"></div>
          </div>
        </div>
      </section>

      <section id="activity-character" class="activity-content tab-content" style="display:none;">
        <h2>üßô Character</h2>
        <div class="cards character-cards">
          <div class="card">
            <h4>Stats</h4>
            <div class="stat"><span>HP</span><span id="stat-hp">100/100</span></div>
            <div class="stat"><span>Shield</span><span id="stat-shield">0/0</span></div>
            <div class="stat"><span>Attack</span><span id="stat-atkBase">5</span></div>
            <div class="stat"><span>Base Armor</span><span id="stat-armorBase">2</span></div>
            <div class="stat"><span>Armor</span><span id="stat-armor">0</span></div>
            <div class="stat"><span>Accuracy</span><span id="stat-accuracy">0</span></div>
            <div class="stat"><span>Dodge</span><span id="stat-dodge">0</span></div>
            <div class="stat"><span>Physique</span><span id="stat-physique">10</span></div>
            <div class="stat"><span>Mind</span><span id="stat-mind">10</span></div>
            <div class="stat"><span>Agility</span><span id="stat-agility">10</span></div>
            <div class="stat"><span>Dexterity</span><span id="stat-dexterity">10</span></div>
            <div class="stat"><span>Comprehension</span><span id="stat-comprehension">10</span></div>
            <div class="stat"><span>Crit Chance</span><span id="stat-criticalChance">5%</span></div>
            <div class="stat"><span>Attack Speed</span><span id="stat-attackSpeed">1.00</span></div>
            <div class="stat"><span>Cooldown Reduction</span><span id="stat-cooldownReduction">0%</span></div>
            <div class="stat"><span>Adventure Speed</span><span id="stat-adventureSpeed">1.00</span></div>
            <div class="stat"><span>Coin</span><span id="stat-coin">0</span></div>
          </div>
          <div class="card">
            <h4>Equipment</h4>
            <div class="gear-tabs">
              <button class="gear-tab-btn active" data-tab="gearEquip">Gear</button>
              <button class="gear-tab-btn" data-tab="gearAbilities">Abilities</button>
            </div>
            <div id="gearEquipSubTab" class="gear-tab-content active">
              <div class="equip-slots">
                <div class="equip-slot" id="slot-mainhand"><span class="slot-label">Weapon</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-head"><span class="slot-label">Head</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-body"><span class="slot-label">Body</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-foot"><span class="slot-label">Feet</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-ring1"><span class="slot-label">Ring 1</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-ring2"><span class="slot-label">Ring 2</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-talisman1"><span class="slot-label">Talisman 1</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-talisman2"><span class="slot-label">Talisman 2</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
                <div class="equip-slot" id="slot-food"><span class="slot-label">Food</span> <span class="slot-name">Empty</span> <div class="slot-actions"><button class="btn small equip-btn">Equip‚Ä¶</button> <button class="btn small unequip-btn">Unequip</button></div></div>
              </div>
              <div class="stat" title="Reduces Physical damage. Mitigation = armor / (armor + K √ó hit), capped at 90%">üõ° <span id="armorVal">0</span></div>
              <div class="stat" title="Chance to hit enemies">‚öî <span id="accuracyVal">0</span></div>
              <div class="stat" title="Chance to avoid attacks">üë£ <span id="dodgeVal">0</span></div>
            </div>
            <div id="gearAbilitiesSubTab" class="gear-tab-content" style="display:none;">
              <div id="abilitySlots"></div>
              <div id="availableAbilities"></div>
            </div>
          </div>
          <div class="card">
            <h4>Inventory</h4>
            <div id="inventoryFilters" class="filters">
              <button class="btn small" data-filter="all">All</button>
              <button class="btn small" data-filter="weapon">Weapons</button>
              <button class="btn small" data-filter="armor">Armor</button>
              <button class="btn small" data-filter="food">Food</button>
            </div>
            <div class="inventory-list" id="inventoryList"></div>
          </div>
          <div class="card">
            <h4>Materials</h4>
            <div class="inventory-list" id="materialsList"></div>
          </div>
          <div class="card">
            <h4>Junk</h4>
            <div class="inventory-list" id="junkList"></div>
          </div>
        </div>
      </section>

      <section id="activity-sect" class="activity-content tab-content" style="display:none;">
        <h2>üèõÔ∏è Sect Management</h2>
        <div class="cards">
          <div class="card">
            <h4>Sect Buildings</h4>
            <p class="muted">Construct and upgrade buildings to enhance your sect's capabilities. Buildings unlock as you advance in cultivation and provide powerful bonuses.</p>
            <div id="buildingsContainer"></div>
          </div>
        </div>
      </section>

      <section id="activity-cooking" class="activity-content tab-content" style="display:none;">
        <h2>üç≥ Cooking</h2>
        <div class="cards">
          <div class="card">
            <h4>Cooking Skill</h4>
            <div class="stat"><span>Level</span><span id="cookingLevel">1</span></div>
            <div class="stat"><span>Experience</span><span id="cookingExp">0</span> / <span id="cookingExpMax">100</span></div>
            <div class="stat"><span>Yield Bonus</span><span id="cookingYieldBonus">0%</span></div>
            <div class="progress-bar">
              <div class="progress-fill" id="cookingProgressFill"></div>
            </div>
          </div>
          
          <div class="card">
            <h4>ü•© Cook Meat</h4>
            <div class="cooking-recipe">
              <div class="recipe-input">
                <div class="ingredient">
                  <div class="ingredient-icon">ü•©</div>
                  <div class="ingredient-info">
                    <div class="ingredient-name">Raw Meat</div>
                    <div class="ingredient-count">Available: <span id="rawMeatCount">0</span></div>
                  </div>
                </div>
                <div class="recipe-arrow">‚Üí</div>
                <div class="ingredient">
                  <div class="ingredient-icon">üçñ</div>
                  <div class="ingredient-info">
                    <div class="ingredient-name">Cooked Meat</div>
                    <div class="ingredient-count">Restores 40 HP</div>
                  </div>
                </div>
              </div>
              <div class="recipe-controls">
                <input type="number" id="cookAmount" min="1" max="1" value="1" class="cook-input">
                <button class="btn primary" id="cookMeatButton" onclick="cookMeat()">üç≥ Cook Meat</button>
              </div>
              <div class="recipe-info">
                <div class="muted">Cooking meat doubles its healing power and adds cooking experience.</div>
                <div class="muted">Higher cooking levels increase yield (currently +<span id="currentYieldBonus">0</span>%).</div>
              </div>
            </div>
          </div>
          
          <div class="card">
            <h4>üì¶ Food Inventory</h4>
            <div class="food-inventory">
              <div class="food-item">
                <div class="food-item-icon">ü•©</div>
                <div class="food-item-info">
                  <div class="food-item-name">Raw Meat</div>
                  <div class="food-item-count"><span id="inventoryRawMeat">0</span></div>
                  <div class="food-item-desc">Restores 20 HP</div>
                </div>
                <button class="btn small" onclick="equipFood('meat', 1)">Equip</button>
              </div>
              <div class="food-item">
                <div class="food-item-icon">üçñ</div>
                <div class="food-item-info">
                  <div class="food-item-name">Cooked Meat</div>
                  <div class="food-item-count"><span id="inventoryCookedMeat">0</span></div>
                  <div class="food-item-desc">Restores 40 HP</div>
                </div>
                <button class="btn small" onclick="equipFood('cookedMeat', 2)">Equip</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-cultivation">
        <div class="cards">
          <div class="card">
            <h4>Cultivation Training</h4>
            <p class="muted">Meditate to gain <strong>Foundation</strong>. Qi regenerates passively. Both must be full to attempt a breakthrough. Pills can boost success.</p>
            <div class="progress-wrap" style="margin:10px 0">
              <span class="badge">Qi</span>
              <div class="bar" style="flex:1"><div class="fill" id="qiFill2"></div></div>
              <span id="qiPct">0%</span>
            </div>
            <div class="progress-wrap" style="margin:10px 0">
              <span class="badge">Foundation</span>
              <div class="bar" style="flex:1"><div class="fill" id="foundFill2"></div></div>
              <span id="foundPct">0%</span>
            </div>
            <div class="row">
              <button class="btn" id="useQiPill"> Use Qi Pill (+25% Qi)</button>
              <button class="btn" id="useBodyPill"> Use Body Pill (+ATK/Armor boost)</button>
              <button class="btn" id="useWardPill"> Use Ward Pill (+Breakthrough chance)</button>
            </div>
            <div class="muted" style="margin-top:8px">Breakthrough chance: <span id="btChance">0</span>%</div>
          </div>

          <div class="card">
            <h4>Sect Upgrades</h4>
            <table>
              <thead><tr><th>Upgrade</th><th>Effect</th><th>Cost</th><th></th></tr></thead>
              <tbody id="upgradeTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="tab-laws">
        <div class="cards">
          <div class="card">
            <h4>Cultivation Laws</h4>
            <p class="muted">Choose your cultivation path after reaching Foundation stage. Each law provides unique bonuses and unlocks powerful skill trees.</p>
            <div class="stat"><span>Law Points</span><span id="lawPoints">0</span></div>
            <div class="stat"><span>Selected Law</span><span id="selectedLaw">None</span></div>
          </div>

          <div class="card">
            <h4>Available Laws</h4>
            <div id="lawSelection"></div>
          </div>

          <div class="card" id="skillTreeCard">
            <div id="skillTrees"></div>
          </div>
        </div>
      </section>

      <section id="tab-gathering">
        <div class="cards">
          <div class="card">
            <h4>Disciples</h4>
            <p class="muted">Assign disciples to gather herbs, ore, and wood. Yields scale with upgrades.</p>
            <div class="stat"><span>Total Disciples</span><span id="discTotal">1</span></div>
            <div class="stat"><span>Unassigned</span><span id="discFree">1</span></div>
          </div>
          <div class="card">
            <h4>Bamboo Grove (Herbs)</h4>
            <div class="stat"><span>Assigned</span><span id="assHerb">0</span></div>
            <div class="row">
              <button class="btn small" data-assign="herbs:+1">+1</button>
              <button class="btn small" data-assign="herbs:-1">-1</button>
            </div>
            <div class="muted">Yield: <span id="yieldHerb">0</span>/s</div>
          </div>
          <div class="card">
            <h4>Spirit Mine (Ore)</h4>
            <div class="stat"><span>Assigned</span><span id="assOre">0</span></div>
            <div class="row">
              <button class="btn small" data-assign="ore:+1">+1</button>
              <button class="btn small" data-assign="ore:-1">-1</button>
            </div>
            <div class="muted">Yield: <span id="yieldOre">0</span>/s</div>
          </div>
          <div class="card">
            <h4>Sacred Forest (Wood)</h4>
            <div class="stat"><span>Assigned</span><span id="assWood">0</span></div>
            <div class="row">
              <button class="btn small" data-assign="wood:+1">+1</button>
              <button class="btn small" data-assign="wood:-1">-1</button>
            </div>
            <div class="muted">Yield: <span id="yieldWood">0</span>/s</div>
          </div>
        </div>
      </section>

      <section id="activity-alchemy" class="activity-content tab-content" style="display:none;">
        <h2>‚öóÔ∏è Alchemy</h2>
        <div class="cards">
          <div class="card">
            <h4>Alchemy Cauldron</h4>
            <p class="muted">Brew pills that boost cultivation and breakthroughs. Success grows with Alchemy level.</p>
            <div class="stat"><span>Level</span><span id="alchLvl">1</span></div>
            <div class="stat"><span>XP</span><span id="alchXp">0</span></div>
            <div class="row">
              <select id="recipeSelect" class="btn">
                <!-- Recipes populated dynamically based on unlock status -->
              </select>
              <button class="btn primary" id="brewBtn">üî• Brew</button>
            </div>
          </div>

          <div class="card">
            <h4>Queue</h4>
            <p class="muted">Slots: <span id="slotCount">1</span></p>
            <table>
              <thead><tr><th>Item</th><th>Progress</th><th>Status</th><th></th></tr></thead>
              <tbody id="queueTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="activity-mind" class="activity-content" style="display:none;">
        <div class="mind-tabs">
          <button class="mind-tab-btn active" data-tab="mindMain">Main</button>
          <button class="mind-tab-btn" data-tab="mindReading">Reading</button>
          <button class="mind-tab-btn" data-tab="mindStats">Stats</button>
          <button class="mind-tab-btn" data-tab="mindPuzzles">Puzzles</button>
        </div>
        <div id="mindMainTab" class="mind-tab-content tab-content active"></div>
        <div id="mindReadingTab" class="mind-tab-content tab-content" style="display:none;"></div>
        <div id="mindStatsTab" class="mind-tab-content tab-content" style="display:none;"></div>
        <div id="mindPuzzlesTab" class="mind-tab-content tab-content" style="display:none;"></div>
      </section>

      <section id="tab-combat">
        <div class="cards">
          <div class="card">
            <h4>Combat Stats</h4>
            <div class="stat"><span>Your ATK</span><span id="atkVal2">5</span></div>
            <div class="stat" title="Reduces Physical damage. Mitigation = armor / (armor + K √ó hit), capped at 90%"><span>üõ° Armor</span><span id="armorVal2">0</span></div>
            <div class="stat"><span>Accuracy</span><span id="accuracyVal2">0</span></div>
            <div class="stat"><span>Dodge</span><span id="dodgeVal2">0</span></div>
          </div>
        </div>
      </section>


      <div class="log-sheet" id="logSheet" data-open="false">
        <button class="log-toggle" id="logToggle" aria-controls="log" aria-expanded="false">Log ‚ñæ</button>
        <div class="log" id="log"></div>
      </div>
    </section>
    <div class="modal-overlay" id="cultivationProgressionOverlay" style="display: none;">
      <div class="modal-backdrop"></div>
      <div class="modal-content card cultivation-progress-card" id="cultivationProgressionCard">
        <div class="card-header">
          <h4>Cultivation Progression</h4>
          <button class="btn small ghost" id="closeProgressBtn">√ó</button>
        </div>
        <p class="muted">Your journey through the realms of cultivation:</p>
        <div id="cultivationProgressionTree" class="progression-tree">
          <!-- Progression tree will be populated by JavaScript -->
        </div>
      </div>
    </div>
    <div class="modal-overlay" id="breakthroughResultOverlay" style="display: none;">
      <div class="modal-backdrop"></div>
      <div class="modal-content card" id="breakthroughResultCard">
        <div class="card-header">
          <h4 id="breakthroughResultTitle">Breakthrough Result</h4>
          <button class="btn small ghost" id="closeBreakthroughResultBtn">√ó</button>
        </div>
        <div id="breakthroughResultBody"></div>
      </div>
    </div>
  </main>

  <div id="debugConsole" class="debug-console" style="display:none;">
    <div id="debugOutput"></div>
    <input id="debugInput" type="text" placeholder="Enter command"/>
    <div>
      <button id="debugRunBtn">Run</button>
      <button id="debugKillBtn">Kill Enemy</button>
    </div>
  </div>

  <div id="astralSkillTreeOverlay" class="astral-skill-tree">
    <div class="starfield"></div>
    <div id="astralInsight" class="astral-insight"></div>
    <div class="astral-zoom-controls">
      <button id="astralZoomIn" class="astral-zoom-btn">+</button>
      <button id="astralZoomOut" class="astral-zoom-btn">‚àí</button>
    </div>
    <button id="closeAstralTree" class="astral-tree-close">Close</button>
    <svg id="astralTreeSvg"></svg>
  </div>

  <script type="module" src="ui/index.js"></script>
  <script type="module">
    import { mountDevQuickMenu } from "./src/ui/dev/devQuickMenu.js";
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", () => mountDevQuickMenu());
    } else {
      mountDevQuickMenu();
    }
  </script>
</body>
</html>
