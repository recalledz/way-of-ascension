
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Way of Ascension ‚Äî Idle Xianxia</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- MYSTIC-REALM-UPDATE: Ambient Qi particles and glimmering motes -->
  <div class="qi-particles">
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
    <div class="qi-particle"></div>
  </div>
  <div class="glimmering-motes">
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
    <div class="glimmer-mote"></div>
  </div>
  <div class="elemental-overlays">
    <div class="elemental-leaf"></div>
    <div class="elemental-leaf"></div>
    <div class="elemental-leaf"></div>
    <div class="elemental-spark"></div>
    <div class="elemental-spark"></div>
    <div class="elemental-ice"></div>
    <div class="elemental-ice"></div>
  </div>
  
  <!-- PNG-based mystic realm background -->
  <div class="mystic-background">
    <!-- MYSTIC-REALM-ENHANCEMENT: Dramatic god rays -->
    <div class="god-rays">
      <div class="god-ray"></div>
      <div class="god-ray"></div>
      <div class="god-ray"></div>
      <div class="god-ray"></div>
      <div class="god-ray"></div>
      <div class="god-ray"></div>
      <div class="god-ray"></div>
      <div class="god-ray"></div>
    </div>
    <div class="mountain-silhouettes mountain-foreground"></div>
    <div class="mountain-silhouettes mountain-midground"></div>
    <div class="mountain-silhouettes mountain-background"></div>
    <div class="ink-wash-cloud cloud-1"></div>
    <div class="ink-wash-cloud cloud-2"></div>
    <div class="ink-wash-cloud cloud-3"></div>
    <!-- MYSTIC-REALM-ENHANCEMENT: Floating islands with glowing energy -->
    <div class="floating-island island-1">
      <div class="energy-glow"></div>
    </div>
    <div class="floating-island island-2">
      <div class="energy-glow"></div>
    </div>
  </div>
  <header>
    <div class="brand">
      <div class="qi-orb" id="qiOrb" aria-hidden="true">
        <div class="yin-yang">
          <div class="yang"></div>
          <div class="yin"></div>
          <div class="yang-dot"></div>
          <div class="yin-dot"></div>
        </div>
      </div>
      <div>
        <h1>Way of Ascension</h1>
        <div class="sub">Idle xianxia cultivation ‚Ä¢ autosaves</div>
      </div>
    </div>
    <div class="topbar" id="top-chips">
      <div class="chip">Task: <span id="currentTask">Idle</span></div>
      <div class="chip">Realm: <span id="realmName">Mortal 1</span></div>
      <div class="chip">Qi: <span id="qiVal">0</span>/<span id="qiCap">100</span></div>
      <div class="chip">Stones: <span id="stonesVal">0</span></div>
      <div class="chip">HP: <span id="hpVal">100</span>/<span id="hpMax">100</span></div>
    </div>
    <div class="right-actions">
      <button class="btn small ghost" id="saveBtn">üíæ Save</button>
      <button class="btn small ghost" id="exportBtn">‚¨áÔ∏è Export</button>
      <button class="btn small ghost" id="importBtn">‚¨ÜÔ∏è Import</button>
      <button class="btn small warn" id="resetBtn" title="Hard reset">‚ôªÔ∏è Reset</button>
    </div>
  </header>

  <main>
    <aside class="left">
      <h3 style="margin-bottom: 16px; text-align: center; color: #c7d2fe;">Activities</h3>
      
      <!-- Leveling Activities Group -->
      <div class="activity-group">
        <h4 class="group-title">‚ö° Training & Skills</h4>
        <div class="activities leveling-activities" id="levelingActivities"></div>
      </div>

      <!-- Separator -->
      <div class="activity-separator">
        <div class="separator-line"></div>
        <div class="separator-text">‚öîÔ∏è</div>
        <div class="separator-line"></div>
      </div>

      <!-- Exploration & Management Activities Group -->
      <div class="activity-group">
        <h4 class="group-title">üåü Exploration & Management</h4>
        <div class="activities management-activities" id="managementActivities"></div>
      </div>

      <!-- Sect Selector -->
      <div class="activity-selector" id="sectSelector" data-activity="sect">
        <div class="activity-name">üèõÔ∏è Sect</div>
        <div class="activity-info" id="sectInfo">0 Buildings</div>
      </div>
    </aside>

    <section class="content">

      <!-- Activity Content Panels -->
      <section id="activity-cultivation" class="activity-content" style="display:none;">
        <div class="cultivation-header">
          <div class="realm-node current" id="currentRealmNode">
            <div class="realm-icon" id="currentRealmIcon">üå±</div>
            <div class="realm-info">
              <div class="realm-name" id="currentRealmName">Mortal</div>
              <div class="realm-description" id="currentRealmDesc">The beginning of your cultivation journey</div>
              <div class="realm-stages" id="currentRealmStages">
                <!-- Stage dots will be populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>
        <div class="cultivation-tabs">
          <button class="cultivation-tab-btn active" data-tab="cultivation">Cultivation</button>
          <button class="cultivation-tab-btn" data-tab="stats">Stats</button>
        </div>

        <div id="cultivationSubTab" class="cultivation-tab-content active">
          <div class="cultivation-layout">
            <div class="cultivation-visualization-container">
              <div class="cultivation-visualization" id="cultivationVisualization">
                
                <!-- Ancient parchment background -->
                <div class="parchment-background">
                  <div class="ink-wash-cloud cloud-1"></div>
                  <div class="ink-wash-cloud cloud-2"></div>
                  <div class="ink-wash-cloud cloud-3"></div>
                </div>

                <!-- Misty fog layers behind silhouette -->
                <div class="misty-fog">
                  <div class="fog-layer-1"></div>
                  <div class="fog-layer-2"></div>
                  <div class="fog-layer-3"></div>
                </div>
                
                <!-- Lotus bloom effect behind silhouette -->
                <div class="lotus-bloom" id="lotusBloom">
                  <div class="bloom-petal petal-1"></div>
                  <div class="bloom-petal petal-2"></div>
                  <div class="bloom-petal petal-3"></div>
                  <div class="bloom-petal petal-4"></div>
                  <div class="bloom-petal petal-5"></div>
                  <div class="bloom-petal petal-6"></div>
                  <div class="bloom-petal petal-7"></div>
                  <div class="bloom-petal petal-8"></div>
                </div>

                <!-- Lotus pose silhouette -->
                <div class="lotus-silhouette">
                  <!-- Particle halo around head/upper torso -->
                  <div class="particle-halo" id="particleHalo">
                    <div class="particle particle-1"></div>
                    <div class="particle particle-2"></div>
                    <div class="particle particle-3"></div>
                    <div class="particle particle-4"></div>
                    <div class="particle particle-5"></div>
                    <div class="particle particle-6"></div>
                    <div class="particle particle-7"></div>
                    <div class="particle particle-8"></div>
                    <div class="particle particle-9"></div>
                    <div class="particle particle-10"></div>
                  </div>

                  <!-- Foundation filling animation -->
                  <div class="foundation-fill" id="foundationFill">
                    <div class="qi-stream stream-1"></div>
                    <div class="qi-stream stream-2"></div>
                    <div class="qi-stream stream-3"></div>
                    <div class="qi-mist"></div>
                  </div>
                  
                  <!-- Yin-Yang in chest area -->
                  <div class="chest-area">
                    <div class="yin-yang-container" id="yinYangContainer">
                      <div class="yin-yang" id="cultivationYinYang">
                        <div class="yang"></div>
                        <div class="yin"></div>
                        <div class="yang-dot"></div>
                        <div class="yin-dot"></div>
                        <div class="inner-glow" id="innerGlow"></div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Ornamental outlines -->
                  <div class="ornamental-outline"></div>
                </div>
                
                <!-- Foundation seal above silhouette -->
                <div class="foundation-display">
                  <div class="foundation-seal">
                    <div class="foundation-text">
                      <span class="foundation-label">Foundation</span>
                      <span class="foundation-numbers" id="foundationNumbers">
                        <span id="foundValSilhouette">0</span> / <span id="foundCapSilhouette">60</span>
                      </span>
                    </div>
                  </div>
                </div>
                
                <!-- Qi display below foundation -->
                <div class="qi-display">
                  <span id="qiText">Qi <span id="qiValSilhouette">0</span>/<span id="qiCapSilhouette">100</span></span>
                  <div class="qi-bar-silhouette">
                    <div class="qi-fill-silhouette" id="qiFillSilhouette"></div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card cultivation-controls-card">
              <h4>Cultivation</h4>
              <div class="cultivation-buttons">
                <button class="btn cultivation-btn primary" id="startCultivationActivity">üßò Start Cultivating</button>
                <button class="btn cultivation-btn warn" id="breakthroughBtnActivity">‚ö° Attempt Breakthrough</button>
                <button class="btn cultivation-btn secondary" id="toggleProgressBtn">üèîÔ∏è View Progress</button>
              </div>
              <div class="cultivation-rate">Foundation gain: <span id="foundationRate">0.0</span>/s</div>
            </div>

            <div class="card cultivation-progress-card" id="cultivationProgressionCard" style="display:none;">
              <div class="card-header">
                <h4>üèîÔ∏è Cultivation Progression</h4>
                <button class="btn small ghost" id="closeProgressBtn">‚úï</button>
              </div>
              <p class="muted">Your journey through the realms of cultivation:</p>
              <div id="cultivationProgressionTree" class="progression-tree">
                <!-- Progression tree will be populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>

        <div id="statsSubTab" class="cultivation-tab-content" style="display:none;">
          <div class="cards">
            <div class="card">
              <h4>Breakthrough Details</h4>
              <div class="stat"><span>Success Chance</span><span id="btChanceActivity">0%</span></div>
              <div class="stat"><span>Power Multiplier</span><span id="powerMultActivity">1x</span></div>
              <div id="breakthroughDetailsActivity" class="muted"></div>
              <div class="row" style="margin-top:12px">
                <button class="btn" id="useQiPillActivity">üíä Use Qi Pill</button>
                <button class="btn" id="useWardPillActivity">üíä Use Ward Pill</button>
              </div>
            </div>

            <div class="card" id="cultivationStatsCard" style="display:none;">
              <h4>üåü Cultivation Stats</h4>
              <p class="muted">Enhanced cultivation abilities and multipliers:</p>
              <div class="stat"><span>Talent</span><span id="cultivationTalent">1.0x</span></div>
              <div class="stat"><span>Comprehension</span><span id="cultivationComprehension">1.0x</span></div>
              <div class="stat"><span>Foundation Mult</span><span id="cultivationFoundationMult">1.0x</span></div>
              <div class="stat"><span>Pill Mult</span><span id="cultivationPillMult">1.0x</span></div>
              <div class="stat"><span>Building Mult</span><span id="cultivationBuildingMult">1.0x</span></div>
              <div class="muted" style="margin-top:8px">These multipliers enhance foundation gain, pill effectiveness, and breakthrough chances</div>
            </div>
          </div>
        </div>
      </section>

      <section id="activity-physique" class="activity-content" style="display:none;">
        <h2> Physique Training</h2>
        <div class="cards">
          <div class="card">
            <h4>Training Status</h4>
            <div class="stat"><span>Physique Level</span><span id="physiqueLevelActivity">1</span></div>
            <div class="stat"><span>Experience</span><span><span id="physiqueExpActivity">0</span>/<span id="physiqueExpMaxActivity">100</span></span></div>
            <div class="bar"><div class="fill" id="physiqueFillActivity"></div></div>
            <div class="stat"><span>Stamina</span><span><span id="currentStamina">100</span>/<span id="maxStamina">100</span></span></div>
            <div class="bar"><div class="fill" id="staminaFill" style="background: linear-gradient(90deg, #22c55e, #16a34a);"></div></div>
            <button class="btn primary" id="startPhysiqueActivity"> Start Training</button>
          </div>
          
          <div class="card" id="activeTrainingCard" style="display:none;">
            <h4> Training Session</h4>
            <p class="muted">Start a training session! Stamina drains during training. Hit the perfect zone for maximum XP!</p>
            
            <div class="training-interface">
              <div class="session-controls" id="sessionControls">
                <button class="btn primary" id="startTrainingSession"> Start Training Session</button>
                <div class="muted" style="margin-top:8px">Sessions drain stamina continuously. Hit the green zone for best results!</div>
              </div>
              
              <div class="training-game" id="trainingGame" style="display:none;">
                <div class="timing-bar-container">
                  <div class="timing-bar" id="timingBar">
                    <div class="perfect-zone" id="perfectZone"></div>
                    <div class="timing-cursor" id="timingCursor"></div>
                  </div>
                </div>
                
                <div class="game-controls">
                  <button class="btn primary large" id="hitButton"> HIT!</button>
                  <div class="session-info">
                    <div class="stat"><span>Session Stamina</span><span id="sessionStamina">100</span></div>
                    <div class="stat"><span>Hits This Session</span><span id="sessionHits">0</span></div>
                    <div class="stat"><span>Session XP</span><span id="sessionXP">0</span></div>
                  </div>
                </div>
                
                <div class="muted" style="margin-top:8px">
                  Perfect (Green): 15-25 XP | Good (Yellow): 8-12 XP | Poor (Red): 3-5 XP
                </div>
              </div>
            </div>
          </div>
          
          <div class="card" id="passiveTrainingCard" style="display:none;">
            <h4> Passive Training</h4>
            <p class="muted">Steady, continuous training at a slower pace. No stamina required.</p>
            <div class="stat"><span>Passive Rate</span><span id="passiveTrainingRate">+2 XP/sec</span></div>
            <div class="stat"><span>Total Gained</span><span id="passiveXpGained">0 XP</span></div>
            <div class="muted" style="margin-top:8px">Passive training provides steady progress while stamina recovers</div>
          </div>
          
          <div class="card" id="physiqueEffectsCard" style="display:none;">
            <h4> Physique Effects</h4>
            <p class="muted">Current bonuses from your physique stat:</p>
            <div class="stat"><span>Current Physique</span><span id="currentPhysiqueStat">10</span></div>
            <div class="stat"><span>Mining Bonus</span><span id="physiqueMiningStat">+0%</span></div>
            <div class="stat"><span>Combat Power</span><span id="physiqueCombatStat">+0</span></div>
            <div class="stat"><span>Carry Capacity</span><span id="physiqueCarryStat">+0</span></div>
            <div class="muted" style="margin-top:8px">Higher physique improves mining yield, combat effectiveness, and carrying capacity</div>
          </div>
        </div>
      </section>

      <section id="activity-mining" class="activity-content" style="display:none;">
        <h2> Mining</h2>
        <div class="cards">
          <div class="card">
            <h4>Mining Status</h4>
            <div class="stat"><span>Mining Level</span><span id="miningLevelActivity">1</span></div>
            <div class="stat"><span>Experience</span><span><span id="miningExpActivity">0</span>/<span id="miningExpMaxActivity">100</span></span></div>
            <div class="bar"><div class="fill" id="miningFillActivity"></div></div>
            <div class="stat"><span>Currently Mining</span><span id="currentlyMining">Nothing</span></div>
            <button class="btn primary" id="startMiningActivity"> Start Mining</button>
          </div>
          
          <div class="card">
            <h4>Resource Selection</h4>
            <p class="muted">Select which resource to mine. Mining is passive - resources are gained automatically over time.</p>
            <div class="mining-resources" id="miningResourceSelection">
              <div class="resource-option" data-resource="stones">
                <input type="radio" name="miningResource" id="mineStones" value="stones" checked>
                <label for="mineStones">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Spirit Stones</span>
                  <span class="resource-rate" id="stonesRate">+2-4/sec</span>
                </label>
              </div>
              <div class="resource-option" data-resource="iron" id="ironOption" style="display:none;">
                <input type="radio" name="miningResource" id="mineIron" value="iron">
                <label for="mineIron">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Iron Ore</span>
                  <span class="resource-rate" id="ironRate">+1-2/sec</span>
                </label>
              </div>
              <div class="resource-option" data-resource="ice" id="iceOption" style="display:none;">
                <input type="radio" name="miningResource" id="mineIce" value="ice">
                <label for="mineIce">
                  <span class="resource-icon"></span>
                  <span class="resource-name">Ice Crystal</span>
                  <span class="resource-rate" id="iceRate">+0.5-1/sec</span>
                </label>
              </div>
            </div>
          </div>
          
          <div class="card" id="miningStatsCard" style="display:none;">
            <h4> Mining Progress</h4>
            <div class="stat"><span>Resources Gained</span><span id="resourcesGained">0</span></div>
            <div class="stat"><span>Mining Rate</span><span id="currentMiningRate">0/sec</span></div>
            <div class="stat"><span>Physique Bonus</span><span id="physiqueYieldBonus">+0%</span></div>
            <div class="muted" style="margin-top:8px">Mining grants experience over time</div>
          </div>
        </div>
      </section>

      <section id="activity-adventure" class="activity-content" style="display:none;">
        <h2>üó∫Ô∏è Adventure</h2>
        <div class="adventure-layout"> <!-- MAP-UI-UPDATE -->
          <!-- Horizontal Progress Bar -->
          <div class="adventure-progress-container"> <!-- MAP-UI-UPDATE -->
            <div class="adventure-progress-bar" id="adventureProgressBar"> <!-- MAP-UI-UPDATE -->
              <!-- Progress segments will be populated by JavaScript -->
            </div>
            <div class="adventure-progress-info"> <!-- MAP-UI-UPDATE -->
              <div class="progress-kills"><span id="killsRequired">0/5</span> kills</div> <!-- MAP-UI-UPDATE -->
            </div>
          </div>
        
        <div class="cards adventure-cards"> <!-- MAP-UI-UPDATE -->
          
          <!-- Persistent Battle Display -->
          <div class="card battle-card expanded-battle"> <!-- MAP-UI-UPDATE -->
            <div class="card-header battle-header"> <!-- MAP-UI-UPDATE -->
              <h4>‚öîÔ∏è Battle Arena</h4>
              <button class="btn small ghost map-button" id="mapButton" title="Adventure Map">üó∫Ô∏è Map</button> <!-- MAP-UI-UPDATE -->
            </div>
            
            <div class="battle-area" id="battleArea">
              <div class="area-background" id="areaBackground"></div>
              
              <div class="combat-display">
                <div class="combatant player">
                  <div class="combatant-name">You</div>
                  <div class="health-bar">
                    <div class="health-fill" id="playerHealthFill"></div>
                    <span class="health-text" id="playerHealthText">100/100</span>
                  </div>
                  <div class="combat-stats">
                    <span>ATK: <span id="playerAttack">10</span></span>
                    <span>Rate: <span id="playerAttackRate">1.0/s</span></span>
                  </div>
                </div>
                
                <div class="combat-vs">VS</div>
                
                <div class="combatant enemy">
                  <div class="enemy-affixes" id="enemyAffixes"></div>
                  <div class="combatant-name" id="enemyName">Select an area to begin</div>
                  <div class="health-bar">
                    <div class="health-fill" id="enemyHealthFill"></div>
                    <span class="health-text" id="enemyHealthText">--/--</span>
                  </div>
                  <div class="combat-stats">
                    <span>ATK: <span id="enemyAttack">--</span></span>
                    <span>Rate: <span id="enemyAttackRate">--/s</span></span>
                  </div>
                </div>
              </div>
              
              <!-- Combat Actions -->
              <div class="combat-controls">
                <button class="btn primary" id="startBattleButton">‚öîÔ∏è Start Battle</button>
                <button class="btn success" id="progressButton" disabled>üöÄ Progress to Next Stage</button>
                <button class="btn danger" id="challengeBossButton" disabled style="display: none;">üëπ Challenge Boss</button>
              </div>
            </div>
            
            <!-- Combat Log -->
            <div class="combat-log" id="combatLog">
              <div class="log-entry">Select an area to begin your adventure...</div>
            </div>
          </div>
          
          <!-- Adventure Tabs -->
          <div class="card adventure-tabs-card">
            <div class="adventure-tabs">
              <button class="adventure-tab-btn active" data-tab="progress">üìä Progress</button>
              <button class="adventure-tab-btn" data-tab="bestiary">üìñ Bestiary</button>
              <button class="adventure-tab-btn" data-tab="equipment">üéí Equipment</button>
              <button class="adventure-tab-btn" data-tab="proficiencies">ü•ä Proficiencies</button>
            </div>
            
            <!-- Progress Tab -->
            <div id="progressTab" class="adventure-tab-content active">
              <div class="stat"><span>Total Kills</span><span id="totalKills">0</span></div>
              <div class="stat"><span>Areas Completed</span><span id="areasCompleted">0</span></div>
              <div class="stat"><span>Zones Unlocked</span><span id="zonesUnlocked">1</span></div>
              <div class="combat-info">
                <div class="stat"><span>Weapon</span><span id="currentWeapon">Fists</span></div>
                <div class="stat"><span>Base Damage</span><span id="baseDamage">5</span></div>
                <div class="stat"><span>Physique Bonus</span><span id="physiqueDamageBonus">+0</span></div>
                <div class="stat"><span>Attack Rate</span><span id="combatAttackRate">1.0/s</span></div>
                <div class="muted" style="margin-top:8px">Damage scales with physique stat. Higher dexterity increases attack rate.</div>
              </div>
            </div>
            
            <!-- Bestiary Tab -->
            <div id="bestiaryTab" class="adventure-tab-content" style="display: none;">
              <div class="bestiary-list" id="bestiaryList">
                <div class="muted">Defeat enemies to unlock their information...</div>
              </div>
            </div>
            
            <!-- Equipment Tab -->
            <div id="equipmentTab" class="adventure-tab-content" style="display: none;">
              <div class="equipment-section">
                <h4>üçΩÔ∏è Food Slots</h4>
                <div class="food-slots">
                  <div class="food-slot" id="foodSlot1" onclick="useFoodSlot(1)">
                    <div class="food-icon">üçΩÔ∏è</div>
                    <div class="food-name">Empty</div>
                    <div class="food-cooldown" id="foodCooldown1"></div>
                  </div>
                  <div class="food-slot" id="foodSlot2" onclick="useFoodSlot(2)">
                    <div class="food-icon">üçΩÔ∏è</div>
                    <div class="food-name">Empty</div>
                    <div class="food-cooldown" id="foodCooldown2"></div>
                  </div>
                  <div class="food-slot" id="foodSlot3" onclick="useFoodSlot(3)">
                    <div class="food-icon">üçΩÔ∏è</div>
                    <div class="food-name">Empty</div>
                    <div class="food-cooldown" id="foodCooldown3"></div>
                  </div>
                </div>
                <div class="food-actions">
                  <button class="btn small" onclick="showActivity('cooking')">üç≥ Go to Cooking</button>
                </div>
              </div>
              
              <div class="equipment-section">
                <h4>üì¶ Food Inventory</h4>
                <div class="food-inventory">
                  <div class="food-item">
                    <div class="food-item-icon">ü•©</div>
                    <div class="food-item-info">
                      <div class="food-item-name">Raw Meat</div>
                      <div class="food-item-count"><span id="inventoryRawMeatAdventure">0</span></div>
                      <div class="food-item-desc">Restores 20 HP</div>
                    </div>
                    <button class="btn small" onclick="equipFood('meat', 1)">Equip Slot 1</button>
                    <button class="btn small" onclick="equipFood('meat', 2)">Equip Slot 2</button>
                    <button class="btn small" onclick="equipFood('meat', 3)">Equip Slot 3</button>
                  </div>
                  <div class="food-item">
                    <div class="food-item-icon">üçñ</div>
                    <div class="food-item-info">
                      <div class="food-item-name">Cooked Meat</div>
                      <div class="food-item-count"><span id="inventoryCookedMeatAdventure">0</span></div>
                      <div class="food-item-desc">Restores 40 HP</div>
                    </div>
                    <button class="btn small" onclick="equipFood('cookedMeat', 1)">Equip Slot 1</button>
                    <button class="btn small" onclick="equipFood('cookedMeat', 2)">Equip Slot 2</button>
                    <button class="btn small" onclick="equipFood('cookedMeat', 3)">Equip Slot 3</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Proficiencies Tab -->
            <div id="proficienciesTab" class="adventure-tab-content" style="display: none;">
              <div class="stat"><span>Fist Level</span><span id="fistLevel">1</span></div>
              <div class="stat"><span>Experience</span><span id="fistExp">0</span> / <span id="fistExpMax">100</span></div>
              <div class="activity-progress-bar"><div class="progress-fill" id="fistExpFill"></div></div>
            </div>
          </div>
        </div>
        </div> <!-- MAP-UI-UPDATE -->
        
        <!-- Map Overlay Modal - MAP-UI-UPDATE -->
        <div class="map-overlay" id="mapOverlay" style="display: none;">
          <div class="map-overlay-backdrop" id="mapOverlayBackdrop"></div>
          <div class="map-panel">
            <div class="map-header">
              <h3>üó∫Ô∏è Adventure Map</h3>
              <button class="btn small ghost close-button" id="closeMapButton" aria-label="Close map">‚úï</button>
            </div>
            <div class="map-content" id="mapContent">
              <!-- Zone accordions will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </section>

      <section id="activity-sect" class="activity-content" style="display:none;">
        <h2>üèõÔ∏è Sect Management</h2>
        <div class="cards">
          <div class="card">
            <h4>Sect Overview</h4>
            <div class="stat"><span>Buildings</span><span id="buildingCountActivity">0</span></div>
            <div class="stat"><span>Disciples</span><span>Coming Soon</span></div>
            <div class="stat"><span>Sect Power</span><span>Coming Soon</span></div>
            <button class="btn primary" id="manageSectActivity">üèóÔ∏è Manage Buildings</button>
          </div>
        </div>
      </section>

      <section id="activity-cooking" class="activity-content" style="display:none;">
        <h2>üç≥ Cooking</h2>
        <div class="cards">
          <div class="card">
            <h4>Cooking Skill</h4>
            <div class="stat"><span>Level</span><span id="cookingLevel">1</span></div>
            <div class="stat"><span>Experience</span><span id="cookingExp">0</span> / <span id="cookingExpMax">100</span></div>
            <div class="stat"><span>Yield Bonus</span><span id="cookingYieldBonus">0%</span></div>
            <div class="progress-bar">
              <div class="progress-fill" id="cookingProgressFill"></div>
            </div>
          </div>
          
          <div class="card">
            <h4>ü•© Cook Meat</h4>
            <div class="cooking-recipe">
              <div class="recipe-input">
                <div class="ingredient">
                  <div class="ingredient-icon">ü•©</div>
                  <div class="ingredient-info">
                    <div class="ingredient-name">Raw Meat</div>
                    <div class="ingredient-count">Available: <span id="rawMeatCount">0</span></div>
                  </div>
                </div>
                <div class="recipe-arrow">‚Üí</div>
                <div class="ingredient">
                  <div class="ingredient-icon">üçñ</div>
                  <div class="ingredient-info">
                    <div class="ingredient-name">Cooked Meat</div>
                    <div class="ingredient-count">Restores 40 HP</div>
                  </div>
                </div>
              </div>
              <div class="recipe-controls">
                <input type="number" id="cookAmount" min="1" max="1" value="1" class="cook-input">
                <button class="btn primary" id="cookMeatButton" onclick="cookMeat()">üç≥ Cook Meat</button>
              </div>
              <div class="recipe-info">
                <div class="muted">Cooking meat doubles its healing power and adds cooking experience.</div>
                <div class="muted">Higher cooking levels increase yield (currently +<span id="currentYieldBonus">0</span>%).</div>
              </div>
            </div>
          </div>
          
          <div class="card">
            <h4>üì¶ Food Inventory</h4>
            <div class="food-inventory">
              <div class="food-item">
                <div class="food-item-icon">ü•©</div>
                <div class="food-item-info">
                  <div class="food-item-name">Raw Meat</div>
                  <div class="food-item-count"><span id="inventoryRawMeat">0</span></div>
                  <div class="food-item-desc">Restores 20 HP</div>
                </div>
                <button class="btn small" onclick="equipFood('meat', 1)">Equip</button>
              </div>
              <div class="food-item">
                <div class="food-item-icon">üçñ</div>
                <div class="food-item-info">
                  <div class="food-item-name">Cooked Meat</div>
                  <div class="food-item-count"><span id="inventoryCookedMeat">0</span></div>
                  <div class="food-item-desc">Restores 40 HP</div>
                </div>
                <button class="btn small" onclick="equipFood('cookedMeat', 2)">Equip</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-cultivation">
        <div class="cards">
          <div class="card">
            <h4>Cultivation Training</h4>
            <p class="muted">Meditate to gain <strong>Foundation</strong>. Qi regenerates passively. Both must be full to attempt a breakthrough. Pills can boost success.</p>
            <div class="progress-wrap" style="margin:10px 0">
              <span class="badge">Qi</span>
              <div class="bar" style="flex:1"><div class="fill" id="qiFill2"></div></div>
              <span id="qiPct">0%</span>
            </div>
            <div class="progress-wrap" style="margin:10px 0">
              <span class="badge">Foundation</span>
              <div class="bar" style="flex:1"><div class="fill" id="foundFill2"></div></div>
              <span id="foundPct">0%</span>
            </div>
            <div class="row">
              <button class="btn" id="useQiPill"> Use Qi Pill (+25% Qi)</button>
              <button class="btn" id="useBodyPill"> Use Body Pill (+ATK/DEF boost)</button>
              <button class="btn" id="useWardPill"> Use Ward Pill (+Breakthrough chance)</button>
            </div>
            <div class="muted" style="margin-top:8px">Breakthrough chance: <span id="btChance">0</span>%</div>
          </div>

          <div class="card">
            <h4>Sect Upgrades</h4>
            <table>
              <thead><tr><th>Upgrade</th><th>Effect</th><th>Cost</th><th></th></tr></thead>
              <tbody id="upgradeTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="tab-laws">
        <div class="cards">
          <div class="card">
            <h4>Cultivation Laws</h4>
            <p class="muted">Choose your cultivation path after reaching Foundation stage. Each law provides unique bonuses and unlocks powerful skill trees.</p>
            <div class="stat"><span>Law Points</span><span id="lawPoints">0</span></div>
            <div class="stat"><span>Selected Law</span><span id="selectedLaw">None</span></div>
          </div>

          <div class="card">
            <h4>Available Laws</h4>
            <div id="lawSelection"></div>
          </div>

          <div class="card" id="skillTreeCard">
            <div id="skillTrees"></div>
          </div>
        </div>
      </section>

      <section id="tab-gathering">
        <div class="cards">
          <div class="card">
            <h4>Disciples</h4>
            <p class="muted">Assign disciples to gather herbs, ore, and wood. Yields scale with upgrades.</p>
            <div class="stat"><span>Total Disciples</span><span id="discTotal">1</span></div>
            <div class="stat"><span>Unassigned</span><span id="discFree">1</span></div>
          </div>
          <div class="card">
            <h4>Bamboo Grove (Herbs)</h4>
            <div class="stat"><span>Assigned</span><span id="assHerb">0</span></div>
            <div class="row">
              <button class="btn small" data-assign="herbs:+1">+1</button>
              <button class="btn small" data-assign="herbs:-1">-1</button>
            </div>
            <div class="muted">Yield: <span id="yieldHerb">0</span>/s</div>
          </div>
          <div class="card">
            <h4>Spirit Mine (Ore)</h4>
            <div class="stat"><span>Assigned</span><span id="assOre">0</span></div>
            <div class="row">
              <button class="btn small" data-assign="ore:+1">+1</button>
              <button class="btn small" data-assign="ore:-1">-1</button>
            </div>
            <div class="muted">Yield: <span id="yieldOre">0</span>/s</div>
          </div>
          <div class="card">
            <h4>Sacred Forest (Wood)</h4>
            <div class="stat"><span>Assigned</span><span id="assWood">0</span></div>
            <div class="row">
              <button class="btn small" data-assign="wood:+1">+1</button>
              <button class="btn small" data-assign="wood:-1">-1</button>
            </div>
            <div class="muted">Yield: <span id="yieldWood">0</span>/s</div>
          </div>
        </div>
      </section>

      <section id="tab-alchemy">
        <div class="cards">
          <div class="card">
            <h4>Alchemy Cauldron</h4>
            <p class="muted">Brew pills that boost cultivation and breakthroughs. Success grows with Alchemy level.</p>
            <div class="stat"><span>Level</span><span id="alchLvl">1</span></div>
            <div class="stat"><span>XP</span><span id="alchXp">0</span></div>
            <div class="row">
              <select id="recipeSelect" class="btn">
                <!-- Recipes populated dynamically based on unlock status -->
              </select>
              <button class="btn primary" id="brewBtn">üî• Brew</button>
            </div>
          </div>

          <div class="card">
            <h4>Queue</h4>
            <p class="muted">Slots: <span id="slotCount">1</span></p>
            <table>
              <thead><tr><th>Item</th><th>Progress</th><th>Status</th><th></th></tr></thead>
              <tbody id="queueTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="tab-combat">
        <div class="cards">
          <div class="card">
            <h4>Spirit Beast Hunts</h4>
            <p class="muted">Hunt beasts for stones and loot. Affixes add spice.</p>
            <div class="row">
              <select id="beastSelect" class="btn"></select>
              <button class="btn primary" id="huntBtn">‚öîÔ∏è Start Hunt</button>
            </div>
            <div class="muted" id="huntStatus">No active hunt.</div>
            <div class="progress-wrap" style="margin-top:10px">
              <span class="badge">Enemy HP</span>
              <div class="bar" style="flex:1"><div class="fill" id="enemyFill"></div></div>
              <span id="enemyHpTxt">‚Äî</span>
            </div>
            <div class="progress-wrap" style="margin-top:6px">
              <span class="badge">Your HP</span>
              <div class="bar" style="flex:1"><div class="fill" id="ourFill"></div></div>
              <span id="ourHpTxt">‚Äî</span>
            </div>
            <p class="muted">Affixes: <span id="affixList">None</span></p>
            <div class="row" style="margin-top:8px">
              <button class="btn small" id="techSlash">üó°Ô∏è Sword Slash</button>
              <button class="btn small" id="techGuard">üõ°Ô∏è Guard</button>
              <button class="btn small" id="techBurst">üí• Qi Burst</button>
            </div>
            <p class="muted" id="techStatus"></p>
          </div>

          <div class="card">
            <h4>Combat Stats</h4>
            <div class="stat"><span>Your ATK</span><span id="atkVal2">5</span></div>
            <div class="stat"><span>Your DEF</span><span id="defVal2">2</span></div>
            <div class="stat"><span>Estimated Win Chance</span><span id="winEst">‚Äî</span></div>
          </div>
        </div>
      </section>

      <section id="tab-sect">
        <div class="cards">
          <div class="card">
            <h4>Sect Buildings</h4>
            <p class="muted">Construct and upgrade buildings to enhance your sect's capabilities. Buildings unlock as you advance in cultivation and provide powerful bonuses.</p>
            <div id="buildingsContainer"></div>
          </div>
        </div>
      </section>

      <div class="log" id="log"></div>
    </section>
  </main>

  <script type="module" src="ui/index.js"></script>
</body>
</html>
